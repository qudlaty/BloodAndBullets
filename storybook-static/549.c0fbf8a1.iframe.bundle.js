"use strict";(self.webpackChunkBloodAndBullets=self.webpackChunkBloodAndBullets||[]).push([[549],{"./src/components/InfoPanelSwitchButton/InfoPanelSwitchButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>InfoPanelSwitchButton_InfoPanelSwitchButton});var react=__webpack_require__("./node_modules/react/index.js"),InfoPanel=__webpack_require__("./src/components/InfoPanel/index.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function InfoPanelSwitchButton_InfoPanelSwitchButton(props){let[isPanelOpen,setIsPanelOpen]=(0,react.useState)(!1),switchPanelState=()=>{console.log("Panel",isPanelOpen),setIsPanelOpen(previousValue=>!previousValue)};return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{className:"info-panel-switch-button",onClick:switchPanelState,children:"ⓘ"}),isPanelOpen&&(0,jsx_runtime.jsx)(InfoPanel.V,{...props,onClose:switchPanelState})]})}try{InfoPanelSwitchButton_InfoPanelSwitchButton.displayName="InfoPanelSwitchButton",InfoPanelSwitchButton_InfoPanelSwitchButton.__docgenInfo={description:"",displayName:"InfoPanelSwitchButton",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Item"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/InfoPanelSwitchButton/InfoPanelSwitchButton.tsx#InfoPanelSwitchButton"]={docgenInfo:InfoPanelSwitchButton_InfoPanelSwitchButton.__docgenInfo,name:"InfoPanelSwitchButton",path:"src/components/InfoPanelSwitchButton/InfoPanelSwitchButton.tsx#InfoPanelSwitchButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/InfoPanelSwitchButton/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>_InfoPanelSwitchButton__WEBPACK_IMPORTED_MODULE_0__.p});var _InfoPanelSwitchButton__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/InfoPanelSwitchButton/InfoPanelSwitchButton.tsx")},"./src/components/InfoPanel/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>_InfoPanel__WEBPACK_IMPORTED_MODULE_0__.V});var _InfoPanel__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/InfoPanel/InfoPanel.tsx")},"./src/components/InventoryItem/InventoryItem.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>InventoryItem_InventoryItem}),__webpack_require__("./node_modules/react/index.js");var services=__webpack_require__("./src/services/index.ts"),LinearDisplay=__webpack_require__("./src/components/LinearDisplay/index.ts"),InfoPanelSwitchButton=__webpack_require__("./src/components/InfoPanelSwitchButton/index.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function InventoryItem_InventoryItem(props){let reloadButton,dropButton,interactButton,ammoCounter;let{item}=props,componentClassName="inventory-item";if(props.onDrop&&(dropButton=(0,jsx_runtime.jsx)("button",{className:"\n          ".concat(componentClassName+"__button","\n          ").concat(componentClassName+"__button-drop","\n        "),onClick:()=>{props.onDrop(item.name)},children:"Drop ↘"})),props.onInteract&&(interactButton=(0,jsx_runtime.jsx)("button",{className:"\n          ".concat(componentClassName+"__button","\n          ").concat(componentClassName+"__button-interact","\n        "),onClick:()=>props.onInteract(item.name),children:props.interactButtonText||"Interact"})),item instanceof services.mq){if(!item.reload||!props.onReload||item instanceof services.qS)reloadButton=null;else{let buttonClassName="".concat(componentClassName,"__button-reload");0===item.charges||"empty"===item.charges?buttonClassName+=" ".concat(buttonClassName,"--empty"):item.charges<item.maxCharges&&(buttonClassName+=" ".concat(buttonClassName,"--partial"));let finalButtonClassName="".concat(componentClassName,"__button")+" "+buttonClassName;reloadButton=(0,jsx_runtime.jsxs)("button",{className:finalButtonClassName,onClick:()=>{props.onReload&&props.onReload(item),props.processInterface&&props.processInterface()},children:["Reload (",item.reloadCostInAP,"AP)"]})}ammoCounter=item.reload&&props.shorterDisplay?" (".concat(item.charges,")"):(0,jsx_runtime.jsx)(LinearDisplay.O,{className:"full",label:item.type==services.vD.energy?"Charges":"Rounds",current:item.charges,max:item.maxCharges})}return(0,jsx_runtime.jsxs)("div",{className:"inventory-item",children:[(0,jsx_runtime.jsxs)("div",{className:"inventory-item__body",children:[(0,jsx_runtime.jsx)("span",{children:item.name}),ammoCounter,(0,jsx_runtime.jsx)(InfoPanelSwitchButton.p,{item:item})]},item.name),(0,jsx_runtime.jsxs)("div",{className:"inventory-item__button-group",children:[reloadButton,interactButton,dropButton]})]},item.id)}try{InventoryItem_InventoryItem.displayName="InventoryItem",InventoryItem_InventoryItem.__docgenInfo={description:"",displayName:"InventoryItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Item"}},interactButtonText:{defaultValue:null,description:"",name:"interactButtonText",required:!1,type:{name:"string"}},shorterDisplay:{defaultValue:null,description:"",name:"shorterDisplay",required:!1,type:{name:"boolean"}},onDrop:{defaultValue:null,description:"",name:"onDrop",required:!1,type:{name:"(itemName: string) => any"}},onReload:{defaultValue:null,description:"",name:"onReload",required:!1,type:{name:"(weapon: RangedWeapon) => any"}},onInteract:{defaultValue:null,description:"",name:"onInteract",required:!1,type:{name:"(itemName: string) => any"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!1,type:{name:"() => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/InventoryItem/InventoryItem.tsx#InventoryItem"]={docgenInfo:InventoryItem_InventoryItem.__docgenInfo,name:"InventoryItem",path:"src/components/InventoryItem/InventoryItem.tsx#InventoryItem"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/LinearDisplay/LinearDisplay.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>LinearDisplay_LinearDisplay}),__webpack_require__("./node_modules/react/index.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function LinearDisplay_LinearDisplay(props){let className="linear-display ".concat(props.className||""),percentage=~~(100*props.current/props.max),overload=percentage>100,negative=percentage<0;overload&&(percentage=100,className+=" linear-display--overloaded"),negative&&(percentage=0);let progressStyle={width:"".concat(percentage,"%")},title=props.title||"".concat(props.current,"/").concat(props.max),amount=props.current,divider=1;props.max>=40&&props.max<100?divider=5:props.max>=100&&(divider=10);let gridSize=100/(amount/=divider),color="rgba(200,200,200,0.4)";return color="black",Object.assign(progressStyle,{backgroundSize:"".concat(gridSize,"% 100%"),backgroundImage:"\n      linear-gradient(to left, ".concat(color," 1px, transparent 1px)\n    ")}),(0,jsx_runtime.jsxs)("div",{className:className,children:[(0,jsx_runtime.jsxs)("div",{className:"linear-display__label",children:[props.label,props.label?":":""," "]}),(0,jsx_runtime.jsx)("div",{className:"linear-display__bar-container",title:title,children:(0,jsx_runtime.jsx)("div",{className:"linear-display__bar-progress",style:progressStyle,children:(0,jsx_runtime.jsxs)("span",{className:"linear-display__bar-progress-text",children:[props.current,overload?"/"+props.max:""," "]})})}),(0,jsx_runtime.jsx)("div",{children:" "})]})}try{LinearDisplay_LinearDisplay.displayName="LinearDisplay",LinearDisplay_LinearDisplay.__docgenInfo={description:"",displayName:"LinearDisplay",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},current:{defaultValue:null,description:"",name:"current",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/LinearDisplay/LinearDisplay.tsx#LinearDisplay"]={docgenInfo:LinearDisplay_LinearDisplay.__docgenInfo,name:"LinearDisplay",path:"src/components/LinearDisplay/LinearDisplay.tsx#LinearDisplay"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/LinearDisplay/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>_LinearDisplay__WEBPACK_IMPORTED_MODULE_0__.O});var _LinearDisplay__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/LinearDisplay/LinearDisplay.tsx")},"./src/components/SlideInPanel/SlideInPanel.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>SlideInPanel_SlideInPanel});var react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function SlideInPanel_SlideInPanel(_ref){let{title,children,className,initiallyOpen}=_ref,[isShownValueForCurrentRender,setIsShownValueForNextRender]=(0,react.useState)(initiallyOpen),baseClassName="slide-in-panel",finalClassName="\n    ".concat(baseClassName," \n    ").concat(baseClassName).concat(isShownValueForCurrentRender?"--shown":"--hidden"," \n    ").concat(className||"","\n  ");return(0,jsx_runtime.jsxs)("div",{className:finalClassName,children:[(0,jsx_runtime.jsx)("div",{className:"slide-in-panel__tab",onClick:()=>{setIsShownValueForNextRender(previousValue=>!previousValue)},title:title,children:title}),(0,jsx_runtime.jsx)("div",{className:"slide-in-panel__content",children:children})]})}var ContainerEdgeSide=function(ContainerEdgeSide){return ContainerEdgeSide.left="left",ContainerEdgeSide.right="right",ContainerEdgeSide.top="top",ContainerEdgeSide.bottom="bottom",ContainerEdgeSide}(ContainerEdgeSide||{});try{SlideInPanel_SlideInPanel.displayName="SlideInPanel",SlideInPanel_SlideInPanel.__docgenInfo={description:"A panel that slides in from the right",displayName:"SlideInPanel",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},initiallyOpen:{defaultValue:null,description:"",name:"initiallyOpen",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/SlideInPanel/SlideInPanel.tsx#SlideInPanel"]={docgenInfo:SlideInPanel_SlideInPanel.__docgenInfo,name:"SlideInPanel",path:"src/components/SlideInPanel/SlideInPanel.tsx#SlideInPanel"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$l:()=>Board,N4:()=>BorderStyle,bL:()=>Cell_Cell,ZX:()=>Controls_Controls,MD:()=>CursorMessage_CursorMessage,Yx:()=>EmojiMapper_EmojiMapper,m7:()=>EntityCard_EntityCard,PB:()=>EntityPawn_EntityPawn,s:()=>FancyButton_FancyButton,_4:()=>GradientBolt_GradientBolt,rj:()=>Grid_Grid,$3:()=>HpBar_HpBar,qx:()=>HudPanel.q,Pg:()=>InventoryList_InventoryList,Og:()=>LinearDisplay.O,_p:()=>MessageBox_MessageBox,wC:()=>ShootingVisualization_ShootingVisualization,x9:()=>SlideInPanel.x,QZ:()=>SquareComponent});var react=__webpack_require__("./node_modules/react/index.js"),Helpers=__webpack_require__("./src/helpers/Helpers.ts");let Board_module={board:"Board_board__09jEj",board__row:"Board_board__row__kf8Ef","board--rotated":"Board_board--rotated__Ey+uy"};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class Board extends react.Component{constructor(){super(...arguments),this.handleClick=i=>{console.log("Handles Click on Board",i),this.props.onClick(i)},this.EntityPawns=()=>this.props.entities.map(entity=>(0,jsx_runtime.jsx)(EntityPawn_EntityPawn,{entity:entity},entity.name)),this.BoardSquares=()=>{let colId,cellId=0,rowId=0;return Array(this.props.size).fill(null).map((row,number)=>{colId=0;let cells=Array(this.props.size).fill(null).map((cell,number)=>this.renderSquare(cellId++,rowId,colId++));return(0,jsx_runtime.jsx)("div",{className:Board_module.board__row,children:cells},rowId++)})}}renderSquare(i,rowId,colId){let square=this.props.squares[i];return(0,jsx_runtime.jsx)(SquareComponent,{squareId:i,className:Helpers.Mk(square),onClick:this.handleClick,blood:square&&square.blood,items:square&&square.items,itemsNumber:square&&square.items&&square.items.length},"r".concat(rowId,"_c").concat(i))}render(){let className=Board_module.board;return this.props.isRotated&&(className+=" ".concat(Board_module["board--rotated"]," board--rotated")),(0,jsx_runtime.jsxs)("div",{className:className,style:this.props.style,children:[this.BoardSquares(),this.EntityPawns()]})}}try{Board.displayName="Board",Board.__docgenInfo={description:"",displayName:"Board",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(i: number) => void"}},squares:{defaultValue:null,description:"",name:"squares",required:!0,type:{name:"Square[]"}},entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"Entity[]"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"number"}},isRotated:{defaultValue:null,description:"",name:"isRotated",required:!0,type:{name:"boolean"}},style:{defaultValue:null,description:"",name:"style",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Board/Board.tsx#Board"]={docgenInfo:Board.__docgenInfo,name:"Board",path:"src/components/Board/Board.tsx#Board"})}catch(__react_docgen_typescript_loader_error){}try{EntitiesList.displayName="EntitiesList",EntitiesList.__docgenInfo={description:"",displayName:"EntitiesList",props:{entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"Entity[]"}},onInventoryClick:{defaultValue:null,description:"",name:"onInventoryClick",required:!0,type:{name:"any"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/EntitiesList/EntitiesList.tsx#EntitiesList"]={docgenInfo:EntitiesList.__docgenInfo,name:"EntitiesList",path:"src/components/EntitiesList/EntitiesList.tsx#EntitiesList"})}catch(__react_docgen_typescript_loader_error){}var services=__webpack_require__("./src/services/index.ts"),InfoPanelSwitchButton=__webpack_require__("./src/components/InfoPanelSwitchButton/index.ts");class EntityCard_EntityCard extends react.Component{constructor(props){super(props),this.handleInventoryItemClick=itemName=>{this.props.onInventoryClick(this.props.entity,itemName)},this.handleInventoryButtonClick=()=>{this.setState(prevState=>({isInventoryOpen:!prevState.isInventoryOpen}))},this.onDrop=itemName=>{let{entity}=this.props;entity.equipment.hands&&entity.equipment.hands.name===itemName&&(entity.unEquipFromHands(),entity.isShooting=!1);let item=entity.takeFromInventory(itemName);item instanceof services.ck?(console.log("Dropping Item"),entity.square.addItem(item)):item instanceof services.JH&&(console.log("Dropping Entity"),services.gB.addEntity(item),entity.square.entity=item,entity.square.entities.push(item),item.position={...entity.position}),this.props.processInterface()},this.onReload=weapon=>{let{entity}=this.props;services.gB.reloadWeapon(entity,weapon),this.props.processInterface()},this.state={isInventoryOpen:!1}}get distanceToTarget(){let{entity}=this.props;return entity.targetPosition?Number(Helpers.cL(entity.targetPosition.x-entity.position.x,entity.targetPosition.y-entity.position.y).toFixed(2)):null}render(){var _entity$inventory;let bleedingText,bleedingReductionText;let{entity}=this.props;if(!entity)return null;let baseClassName="entity-card",finalClassName=baseClassName;entity.active&&(finalClassName+=" ".concat(baseClassName,"--active")),entity.isFriendly&&(finalClassName+=" ".concat(baseClassName,"--friendly")),entity.isDead&&(finalClassName+=" ".concat(baseClassName,"--dead"));let inHands=entity.equipment&&entity.equipment.hands;return entity.bleedingReductionPerTurn&&(bleedingReductionText=(0,jsx_runtime.jsxs)("span",{className:"bleeding-info__reduction",children:["(-",entity.bleedingReductionPerTurn,(0,jsx_runtime.jsx)("small",{className:"bleeding-info__reduction__unit",children:"/Turn"}),")"]})),entity.bleeding&&(bleedingText=(0,jsx_runtime.jsxs)("span",{className:"bleeding-info",children:["Bleeding: ",entity.bleeding," ",bleedingReductionText]})),(0,jsx_runtime.jsxs)("div",{className:finalClassName,children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("div",{className:"entity-card__portrait",children:(0,jsx_runtime.jsx)(EmojiMapper_EmojiMapper,{emoji:entity.icon})})}),(0,jsx_runtime.jsxs)("strong",{title:"Name",children:[entity.isDead&&"Dead ",entity.name]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("small",{className:"entity-data__rank",children:null==entity?void 0:entity.rank}),(0,jsx_runtime.jsx)(InfoPanelSwitchButton.p,{item:entity}),(0,jsx_runtime.jsxs)("div",{className:"entity-data__status-displays",children:[(0,jsx_runtime.jsx)(LinearDisplay.O,{className:"full",label:"AP",current:entity.actionPoints,max:entity.maxActionPoints}),(0,jsx_runtime.jsx)(LinearDisplay.O,{className:"full",label:"HP",current:entity.hp,max:entity.maxHp}),bleedingText]}),(0,jsx_runtime.jsx)("div",{className:"equipment-panel",children:(0,jsx_runtime.jsx)(InventoryList_InventoryList,{label:"",title:"In hands",interactButtonText:"Unequip →",onInteract:this.state.isInventoryOpen&&this.handleInventoryItemClick,onReload:this.props.entity.isAlive&&this.onReload,onDrop:this.props.entity.isDead&&this.onDrop,inventory:inHands&&[inHands],shorterDisplay:this.props.shorterDisplay,processInterface:()=>this.props.processInterface()})}),this.state.isInventoryOpen&&(0,jsx_runtime.jsx)("div",{className:"inventory-panel",children:(0,jsx_runtime.jsx)(InventoryList_InventoryList,{label:"Inventory",title:"In backpack",interactButtonText:" ← Equip",onInteract:this.handleInventoryItemClick,onDrop:this.onDrop,onClose:this.handleInventoryButtonClick,inventory:entity.inventory,processInterface:()=>this.props.processInterface()})}),(0,jsx_runtime.jsxs)("button",{className:"inventory-item__button inventory-button",onClick:()=>this.handleInventoryButtonClick(),children:["INVENTORY (",(null===(_entity$inventory=entity.inventory)||void 0===_entity$inventory?void 0:_entity$inventory.length)||0,")"]}),entity.isDead&&(0,jsx_runtime.jsx)("button",{className:"inventory-item__button pick-up-button",onClick:()=>this.props.onEntityClick(entity.name),children:"Pick up the body"})]})}}try{EntityCard_EntityCard.displayName="EntityCard",EntityCard_EntityCard.__docgenInfo={description:"",displayName:"EntityCard",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Entity"}},shorterDisplay:{defaultValue:null,description:"",name:"shorterDisplay",required:!1,type:{name:"boolean"}},onInventoryClick:{defaultValue:null,description:"",name:"onInventoryClick",required:!1,type:{name:"(entity: Entity, itemName: string) => any"}},onEntityClick:{defaultValue:null,description:"",name:"onEntityClick",required:!1,type:{name:"(entityName: string) => any"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!1,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/EntityCard/EntityCard.tsx#EntityCard"]={docgenInfo:EntityCard_EntityCard.__docgenInfo,name:"EntityCard",path:"src/components/EntityCard/EntityCard.tsx#EntityCard"})}catch(__react_docgen_typescript_loader_error){}class EntityPawn_EntityPawn extends react.Component{constructor(){super(...arguments),this.randomTime="".concat((Math.random()+.5).toFixed(2),"s")}render(){var _entity$equipment,_entity$equipment$han;let{entity}=this.props,square=services.fi.getSquareFromPosition(entity.position.x,entity.position.y),classNameBase="entity-pawn__icon",className="".concat(classNameBase),classessFromFlags=Helpers.l$(entity,classNameBase);classessFromFlags+=Helpers.l$(square,classNameBase),className+=" ".concat(classessFromFlags," ");let fof=entity.isFriendly?"friendly":"hostile",color=entity.isFriendly?"green":"red",zIndex=entity.isShooting?5:1,animationBreathing=entity.isBreathing?"breathing ".concat(this.randomTime," alternate infinite linear"):"none",customPropsObject={weaponType:null===(_entity$equipment=entity.equipment)||void 0===_entity$equipment?void 0:null===(_entity$equipment$han=_entity$equipment.hands)||void 0===_entity$equipment$han?void 0:_entity$equipment$han.type,actionId:entity.attackNumber};return(0,jsx_runtime.jsxs)("div",{className:"entity-pawn ".concat(entity.isDead?"entity-pawn--dead":""),style:{left:"calc(".concat(13,"px + ").concat(4*entity.position.x,"px + ").concat(entity.position.x,"em)"),top:"calc(".concat(13,"px + ").concat(4*entity.position.y,"px + ").concat(entity.position.y,"em)"),zIndex:zIndex},children:[(0,jsx_runtime.jsx)("div",{className:"entity-pawn__health-display "+fof,children:(0,jsx_runtime.jsx)(HpBar_HpBar,{current:entity.hp,max:entity.maxHp,color:color})}),(0,jsx_runtime.jsx)("div",{className:className,style:{animation:animationBreathing},children:(0,jsx_runtime.jsx)(EmojiMapper_EmojiMapper,{emoji:entity.icon})}),entity.isShooting&&(0,jsx_runtime.jsx)(ShootingVisualization_ShootingVisualization,{...entity,...customPropsObject})]},entity.name)}}try{EntityPawn_EntityPawn.displayName="EntityPawn",EntityPawn_EntityPawn.__docgenInfo={description:"",displayName:"EntityPawn",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Entity"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/EntityPawn/EntityPawn.tsx#EntityPawn"]={docgenInfo:EntityPawn_EntityPawn.__docgenInfo,name:"EntityPawn",path:"src/components/EntityPawn/EntityPawn.tsx#EntityPawn"})}catch(__react_docgen_typescript_loader_error){}class EmojiMapper_EmojiMapper extends react.Component{constructor(){super(...arguments),this.emojiMap={"🐙":"octopus","🦑":"squid","🕷️":"spider","🦟":"mosquito","🐜":"ant","🦠":"microbe","🧑‍🚀":"astronaut","🤖":"robot","🛢️":"oildrum"}}render(){let{emoji}=this.props,emojiMappedTo=this.emojiMap[emoji],output=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});return output=emojiMappedTo?(0,jsx_runtime.jsx)("div",{className:"emoji emoji-"+emojiMappedTo}):(0,jsx_runtime.jsxs)("div",{children:[emoji,"."]}),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:output})}}try{EmojiMapper_EmojiMapper.displayName="EmojiMapper",EmojiMapper_EmojiMapper.__docgenInfo={description:"",displayName:"EmojiMapper",props:{emoji:{defaultValue:null,description:"",name:"emoji",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/EmojiMapper/EmojiMapper.tsx#EmojiMapper"]={docgenInfo:EmojiMapper_EmojiMapper.__docgenInfo,name:"EmojiMapper",path:"src/components/EmojiMapper/EmojiMapper.tsx#EmojiMapper"})}catch(__react_docgen_typescript_loader_error){}var resources=__webpack_require__("./src/resources/index.ts");class TargetedSquareInfo extends react.Component{constructor(props){super(props),this.boxSerialNumber=0,this.handleInventoryButtonClick=()=>{this.setState(prevState=>({isInventoryOpen:!prevState.isInventoryOpen}))},this.onItemClick=itemName=>{let{selected,targeted,squareNumber}=this.props,targetedSquarePosition=services.fi.getSquarePositionFromIndex(squareNumber);if(selected&&targeted&&selected.position.x===targetedSquarePosition.x&&selected.position.y===targetedSquarePosition.y){let item=targeted.takeFromInventory(itemName);if(!item){item=targeted.entities.find(entity=>entity.name===itemName);let square=services.fi.getSquareFromPosition(targetedSquarePosition.x,targetedSquarePosition.y);services.gB.removeEntityFromListOfEntities(square.entities,item),services.gB.removeEntity(item)}selected.addToInventory(item),selected.equipment.hands||selected.equipInHands(item.name)}else services.ez.send("".concat(selected.name," can't pick up ").concat(itemName,". They need to be on the same square to do that."));this.props.processInterface()},this.state={isInventoryOpen:!1}}componentDidUpdate(prevProps){prevProps.squareNumber!==this.props.squareNumber&&this.setState({isInventoryOpen:!1})}onMoveClick(selected,targetedSquarePosition){let targetedSquare=services.fi.getSquareFromPosition(targetedSquarePosition.x,targetedSquarePosition.y);selected.setMoveDestinationPosition(targetedSquarePosition),targetedSquare.isChosenDestination=!0,this.props.processInterface()}onAttackClick(selected,targetedSquarePosition){selected.attackPosition(targetedSquarePosition),this.props.processInterface()}onAddStructureClick(targetedSquarePosition,structureType){let box=Object.assign({},resources.Qp[structureType]),targetPosition=Object.assign({},targetedSquarePosition);box.position=targetPosition,box.name+=this.boxSerialNumber++;let square=services.fi.getSquareFromPosition(targetedSquarePosition.x,targetedSquarePosition.y),newStructure=new services.JH(box);square.entities.push(newStructure),services.gB.entities.push(newStructure),this.props.processInterface()}render(){let items;let{targeted,selected,squareNumber}=this.props;if(!targeted)return null;let targetedSquarePosition=services.fi.getSquarePositionFromIndex(squareNumber),entityInfo=[],availableActions=[];if(targeted.entities&&targeted.entities.length&&targeted.entities.forEach(i=>{selected!==i&&entityInfo.push((0,jsx_runtime.jsx)(EntityCard_EntityCard,{onEntityClick:this.onItemClick,onInventoryClick:this.props.onInventoryClick,entity:i,shorterDisplay:!0,processInterface:()=>this.props.processInterface()},i.name))}),targeted.items&&targeted.items.length&&(items=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[this.state.isInventoryOpen&&(0,jsx_runtime.jsx)("div",{className:"inventory-panel",children:(0,jsx_runtime.jsx)(InventoryList_InventoryList,{label:"Items on the floor",title:"On the floor",interactButtonText:"↖ Pick up",onInteract:this.onItemClick,onDrop:null,onReload:null,onClose:this.handleInventoryButtonClick,inventory:targeted.items,processInterface:()=>this.props.processInterface()})}),(0,jsx_runtime.jsxs)("button",{className:"\n              inventory-list__button \n              inventory-button\n            ",onClick:()=>this.handleInventoryButtonClick(),children:["Show items on the floor (",targeted.items.length,")"]})]})),selected){let distanceToSelected=Helpers.cL(targetedSquarePosition.x-selected.position.x,targetedSquarePosition.y-selected.position.y);distanceToSelected.toFixed(2),0!==distanceToSelected&&(targeted.isAvailableDestination&&(availableActions[0]=(0,jsx_runtime.jsx)("button",{onClick:()=>this.onMoveClick(selected,targetedSquarePosition),className:"button",children:"Move"},"move")),targeted.entity&&(availableActions[1]=(0,jsx_runtime.jsx)("button",{onClick:()=>this.onAttackClick(selected,targetedSquarePosition),className:"button",children:"Attack"},"attack")))}targetedSquarePosition&&(targetedSquarePosition.x,targetedSquarePosition.y),targeted.blood&&targeted.blood;let square=services.fi.getSquareFromPosition(targetedSquarePosition.x,targetedSquarePosition.y);return(0,jsx_runtime.jsxs)("div",{className:this.props.className,children:[(0,jsx_runtime.jsx)("strong",{className:"targeted__label",children:"Target square Info"}),(0,jsx_runtime.jsxs)("code",{children:[square.icon," ",square.name]}),square.description&&(0,jsx_runtime.jsx)("p",{className:"square-description",children:square.description}),(0,jsx_runtime.jsx)("div",{children:entityInfo}),(0,jsx_runtime.jsx)("div",{children:availableActions}),items]})}}try{TargetedSquareInfo.displayName="TargetedSquareInfo",TargetedSquareInfo.__docgenInfo={description:"",displayName:"TargetedSquareInfo",props:{className:{defaultValue:null,description:"",name:"className",required:!0,type:{name:"string"}},squareNumber:{defaultValue:null,description:"",name:"squareNumber",required:!0,type:{name:"number"}},squares:{defaultValue:null,description:"",name:"squares",required:!0,type:{name:"Square[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"Entity"}},targeted:{defaultValue:null,description:"",name:"targeted",required:!0,type:{name:"Square"}},onInventoryClick:{defaultValue:null,description:"",name:"onInventoryClick",required:!0,type:{name:"(entity: Entity, itemName: string) => void"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Game/TargetedSquareInfo.tsx#TargetedSquareInfo"]={docgenInfo:TargetedSquareInfo.__docgenInfo,name:"TargetedSquareInfo",path:"src/components/Game/TargetedSquareInfo.tsx#TargetedSquareInfo"})}catch(__react_docgen_typescript_loader_error){}class SelectedEntityInfo extends react.Component{render(){return this.props.selected?(0,jsx_runtime.jsxs)("div",{className:"selected",children:[(0,jsx_runtime.jsx)("strong",{className:"selected__label",children:"Active entity "}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(EntityCard_EntityCard,{onInventoryClick:this.props.onInventoryClick,entity:this.props.selected,processInterface:()=>this.props.processInterface()})}),(0,jsx_runtime.jsxs)("button",{onClick:this.props.handleDeselectAllEntities,className:"button",children:[" ","Deselect"]})]}):null}}try{SelectedEntityInfo.displayName="SelectedEntityInfo",SelectedEntityInfo.__docgenInfo={description:"",displayName:"SelectedEntityInfo",props:{selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"Entity"}},onInventoryClick:{defaultValue:null,description:"",name:"onInventoryClick",required:!0,type:{name:"(entity: Entity, itemName: string) => void"}},handleDeselectAllEntities:{defaultValue:null,description:"",name:"handleDeselectAllEntities",required:!0,type:{name:"() => void"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Game/SelectedEntityInfo.tsx#SelectedEntityInfo"]={docgenInfo:SelectedEntityInfo.__docgenInfo,name:"SelectedEntityInfo",path:"src/components/Game/SelectedEntityInfo.tsx#SelectedEntityInfo"})}catch(__react_docgen_typescript_loader_error){}let GameActions=null;class Game_Game extends react.PureComponent{constructor(props){super(props),this.renderCounter=0,this.turnNumber=0,services.i4.loadBuiltInMap(),services.i4.loadPredefinedEntitities(),services.gB.setSelected(services.gB.findEntityById("Lazer Blady")),this.state=new services.D2,GameActions=new services.NR(this),console.log("Initial state dump:",this.state)}componentDidMount(){this.startIfAutoLoopIsOn(),services.ez.send("Mission loaded"),GameActions.processInterface(),GameActions.startUpdatingClickPositionCssVariables()}startIfAutoLoopIsOn(){this.state.isAutoLoopOn&&GameActions.loop()}calculateFriendlyActionPoints(){return services.gB.entities.filter(entity=>entity.isFriendly).reduce((previousValue,entity)=>previousValue+entity.actionPoints,0)}render(){return(0,jsx_runtime.jsxs)("div",{className:"game game-hud",children:[(0,jsx_runtime.jsx)(CursorMessage_CursorMessage,{messageText:services.ez.cursorMessage,messageTimeInMs:1500},services.ez.cursorMessageNumber),(0,jsx_runtime.jsxs)("section",{className:"section-details",children:[(0,jsx_runtime.jsx)(SelectedEntityInfo,{selected:this.state.selected,handleDeselectAllEntities:GameActions.handleDeselectAllEntities,onInventoryClick:GameActions.onInventoryClick,processInterface:()=>GameActions.processInterface()}),(0,jsx_runtime.jsx)(TargetedSquareInfo,{className:"targeted",squareNumber:this.state.targetedSquareNumber,squares:this.state.squares,selected:this.state.selected,targeted:this.state.targeted,onInventoryClick:GameActions.onInventoryClick,processInterface:()=>GameActions.processInterface()})]}),(0,jsx_runtime.jsxs)("main",{className:"section-main",children:[(0,jsx_runtime.jsx)("div",{className:"game__board",children:(0,jsx_runtime.jsx)(Board,{squares:this.state.squares,entities:this.state.entities,onClick:i=>GameActions.handleClickV2(i),size:this.state.arenaSize,isRotated:this.state.isBoardRotated,style:{fontSize:"".concat(this.state.squareSize,"px")}})}),(0,jsx_runtime.jsxs)("section",{className:"section-status",children:[(0,jsx_runtime.jsx)(MessageBox_MessageBox,{}),(0,jsx_runtime.jsx)(HudPanel.q,{title:"=>",children:(0,jsx_runtime.jsx)("button",{onClick:GameActions.endTurn,className:"button next_tick next_turn",children:"End Turn"})})]})]}),(0,jsx_runtime.jsx)(SlideInPanel.x,{title:"Actions",initiallyOpen:!0,children:(0,jsx_runtime.jsx)("div",{className:"game__info",children:(0,jsx_runtime.jsxs)("div",{className:"actions",children:[(0,jsx_runtime.jsx)("button",{onClick:GameActions.toggleEditorMode,children:"Editor Mode"}),(0,jsx_runtime.jsx)("button",{onClick:services.i4.saveMap,children:"Save Map"}),(0,jsx_runtime.jsx)("button",{onClick:()=>services.i4.loadMap(GameActions),children:"Load Map"}),(0,jsx_runtime.jsx)("button",{onClick:()=>services.i4.generateMAP(),children:"Generate MAP"}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.toggleRotateBoard,children:"Rotate Board"}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.zoomIn,children:"Zoom In (+)"}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.zoomOut,children:"Zoom Out (-)"}),(0,jsx_runtime.jsx)("button",{onClick:()=>GameActions.nuke(40),className:"button-nuke",children:"Nuke All"}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.ceaseFire,children:"Cease Fire"}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.executeActions,className:"execute_actions",children:"Execute Actions"}),(0,jsx_runtime.jsxs)("span",{className:"st ep-counter",children:["Turn: ",this.turnNumber]}),(0,jsx_runtime.jsxs)("label",{className:"button auto-cycle",children:[(0,jsx_runtime.jsx)("input",{type:"checkbox",checked:this.state.isAutoLoopOn,onChange:GameActions.switchAutoLoop}),(0,jsx_runtime.jsx)("span",{children:"Auto Cycle"})]}),(0,jsx_runtime.jsx)("button",{onClick:GameActions.endTurn,className:"button next_tick next_turn",children:"End Turn"})]})})})]})}}try{Game_Game.displayName="Game",Game_Game.__docgenInfo={description:"Game composes all the parts of the interface together",displayName:"Game",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Game/Game.tsx#Game"]={docgenInfo:Game_Game.__docgenInfo,name:"Game",path:"src/components/Game/Game.tsx#Game"})}catch(__react_docgen_typescript_loader_error){}class Blood extends react.PureComponent{render(){let{bloodAmount}=this.props;if(bloodAmount<=0){console.error("Blood amount zero or negative.");return}let bloodDrops=[],i=bloodAmount;for(;i--;)bloodDrops.push((0,jsx_runtime.jsx)("span",{className:"blood__drop",style:{position:"absolute",fontSize:"".concat(1+3*Math.random(),"em"),left:"calc(".concat(0+100*Math.random(),"% - 0.4em)"),top:"calc(".concat(0+100*Math.random(),"% - 0.5em)")},children:"o"},i));return(0,jsx_runtime.jsxs)("div",{className:"square__blood",style:{background:"rgba(255, 0, 0, 0)"},children:[bloodDrops,(0,jsx_runtime.jsx)("span",{className:"blood__text",children:bloodAmount})]})}}try{Blood.displayName="Blood",Blood.__docgenInfo={description:"",displayName:"Blood",props:{bloodAmount:{defaultValue:null,description:"",name:"bloodAmount",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Square/Blood.tsx#Blood"]={docgenInfo:Blood.__docgenInfo,name:"Blood",path:"src/components/Square/Blood.tsx#Blood"})}catch(__react_docgen_typescript_loader_error){}class Items extends react.PureComponent{constructor(){super(...arguments),this.itemsIcons=[]}render(){let{items,itemsNumber}=this.props;return items?(items.forEach(item=>{item.icon&&this.itemsIcons.push((0,jsx_runtime.jsx)("div",{className:"square__item-icon",children:item.icon}))}),(0,jsx_runtime.jsxs)("div",{className:"square__items",children:[(0,jsx_runtime.jsx)("div",{className:"square__items-icons",children:this.itemsIcons}),(0,jsx_runtime.jsx)("div",{className:"square__items-number",children:itemsNumber||""})]})):null}}try{Items.displayName="Items",Items.__docgenInfo={description:"",displayName:"Items",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"Item[]"}},itemsNumber:{defaultValue:null,description:"",name:"itemsNumber",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Square/Items.tsx#Items"]={docgenInfo:Items.__docgenInfo,name:"Items",path:"src/components/Square/Items.tsx#Items"})}catch(__react_docgen_typescript_loader_error){}class SquareComponent extends react.PureComponent{constructor(){super(...arguments),this.onClick=()=>{this.props.onClick(this.props.squareId)}}render(){function cuboid(classPrefix){let i=6,cuboidFaces=[];for(;i--;)cuboidFaces.push((0,jsx_runtime.jsx)("div",{className:"".concat(classPrefix,"__cuboid-face")},i));return(0,jsx_runtime.jsx)("div",{className:"".concat(classPrefix,"__cuboid"),children:cuboidFaces})}let squareModel=services.fi.squares[this.props.squareId],icon=null==squareModel?void 0:squareModel.icon;return(0,jsx_runtime.jsxs)("button",{className:"square "+this.props.className,onClick:this.onClick,children:[(0,jsx_runtime.jsx)("div",{className:"square__content",children:icon}),(0,jsx_runtime.jsx)(Blood,{bloodAmount:this.props.blood}),(0,jsx_runtime.jsx)(Items,{items:this.props.items,itemsNumber:this.props.itemsNumber}),cuboid("square")]})}}try{SquareComponent.displayName="SquareComponent",SquareComponent.__docgenInfo={description:"Displays a single square with blood and items on it.",displayName:"SquareComponent",props:{squareId:{defaultValue:null,description:"Unique square id",name:"squareId",required:!0,type:{name:"number"}},className:{defaultValue:null,description:"Optional CSS class name",name:"className",required:!1,type:{name:"string"}},onClick:{defaultValue:null,description:"Handler for this square click",name:"onClick",required:!0,type:{name:"(squareIndex: number) => void"}},blood:{defaultValue:null,description:"The amount of blood on this square",name:"blood",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"A list of items on this square",name:"items",required:!0,type:{name:"Item[]"}},itemsNumber:{defaultValue:null,description:"A number of items on this square.\nHere to trigger an update when list length changes.",name:"itemsNumber",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Square/Square.tsx#SquareComponent"]={docgenInfo:SquareComponent.__docgenInfo,name:"SquareComponent",path:"src/components/Square/Square.tsx#SquareComponent"})}catch(__react_docgen_typescript_loader_error){}var LinearDisplay=__webpack_require__("./src/components/LinearDisplay/index.ts"),HudPanel=__webpack_require__("./src/components/HudPanel/index.ts");class Cell_Cell extends react.PureComponent{constructor(){super(...arguments),this.state={}}render(){var _this$props,_this$props2;return(0,jsx_runtime.jsx)("div",{className:"cell",style:null===(_this$props=this.props)||void 0===_this$props?void 0:_this$props.style,children:(0,jsx_runtime.jsx)("div",{className:"cell__contents",children:null===(_this$props2=this.props)||void 0===_this$props2?void 0:_this$props2.children})})}}try{Cell_Cell.displayName="Cell",Cell_Cell.__docgenInfo={description:'Renders children in a container with a "cell" CSS class',displayName:"Cell",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Grid/Cell.tsx#Cell"]={docgenInfo:Cell_Cell.__docgenInfo,name:"Cell",path:"src/components/Grid/Cell.tsx#Cell"})}catch(__react_docgen_typescript_loader_error){}class Grid_Grid extends react.Component{renderGrid(){let{cellSize,gapSize,width,height,startAt,cellBorderColor}=this.props,rows=[],gapStyle=gapSize>-1?{gridGap:"".concat(gapSize,"px ").concat(gapSize,"px")}:{},rowStyle={gridTemplateColumns:"repeat(".concat(width+1,", 1em)"),...gapStyle},gridStyle={gridTemplateRows:"repeat(".concat(height+1,", 1em)"),...gapStyle,...cellSize>-1?{fontSize:"".concat(cellSize,"px")}:{}},borderStyle=cellBorderColor?{border:"1px solid ".concat(cellBorderColor)}:{};for(let y=0;y<=height;y++){let sourceY=startAt[1]+y,currentRow=[];for(let x=0;x<=width;x++){let sourceX=startAt[0]+x,currentCell=(0,jsx_runtime.jsxs)(Cell_Cell,{style:borderStyle,children:[sourceX,", ",sourceY]},"$key_".concat(sourceX,"_").concat(sourceY));currentRow.push(currentCell)}rows.push((0,jsx_runtime.jsx)("div",{className:"row",style:rowStyle,children:currentRow},"$key_X_".concat(sourceY)))}return(0,jsx_runtime.jsx)("div",{className:"grid",style:gridStyle,children:rows})}render(){return this.renderGrid()}}try{Grid_Grid.displayName="Grid",Grid_Grid.__docgenInfo={description:"Renders a grid X by Y, starting from a given position",displayName:"Grid",props:{cellSize:{defaultValue:null,description:"size of the grid square in pixels",name:"cellSize",required:!1,type:{name:"number"}},gapSize:{defaultValue:null,description:"size of the grid gap between squares in pixels",name:"gapSize",required:!1,type:{name:"number"}},width:{defaultValue:null,description:"width of the grid in number of squares",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"height of the grid in number of squares",name:"height",required:!0,type:{name:"number"}},startAt:{defaultValue:null,description:"params given to the first square (top left one)",name:"startAt",required:!0,type:{name:"[number, number]"}},cellBorderColor:{defaultValue:null,description:"color for the cell border",name:"cellBorderColor",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Grid/Grid.tsx#Grid"]={docgenInfo:Grid_Grid.__docgenInfo,name:"Grid",path:"src/components/Grid/Grid.tsx#Grid"})}catch(__react_docgen_typescript_loader_error){}class Controls_Controls extends react.Component{constructor(props){super(props),this.state={w:!1,s:!1,a:!1,d:!1,space:!1}}componentDidMount(){document.addEventListener("keydown",e=>this.onKeyDown(e),!1),document.addEventListener("keyup",e=>this.onKeyUp(e),!1)}onKeyDown(event){switch(event.keyCode){case 87:this.setState({w:!0}),this.props.onKeyPress("w");break;case 83:this.setState({s:!0}),this.props.onKeyPress("s");break;case 65:this.setState({a:!0}),this.props.onKeyPress("a");break;case 68:this.setState({d:!0}),this.props.onKeyPress("d");break;case 32:this.setState({space:!0}),this.props.onKeyPress("space")}}onKeyUp(event){switch(event.keyCode){case 87:this.setState({w:!1});break;case 83:this.setState({s:!1});break;case 65:this.setState({a:!1});break;case 68:this.setState({d:!1});break;case 32:this.setState({space:!1})}}render(){return(0,jsx_runtime.jsxs)("div",{className:"controls",children:["[",(0,jsx_runtime.jsx)("span",{className:"".concat(this.state.w?"pressed":""," key"),children:"W"}),"] [",(0,jsx_runtime.jsx)("span",{className:"".concat(this.state.s?"pressed":""," key"),children:"S"}),"] [",(0,jsx_runtime.jsx)("span",{className:"".concat(this.state.a?"pressed":""," key"),children:"A"}),"] [",(0,jsx_runtime.jsx)("span",{className:"".concat(this.state.d?"pressed":""," key"),children:"D"}),"]   [",(0,jsx_runtime.jsx)("span",{className:"".concat(this.state.space?"pressed":""," key"),children:"space"}),"]"]})}}try{Controls_Controls.displayName="Controls",Controls_Controls.__docgenInfo={description:"",displayName:"Controls",props:{keys:{defaultValue:null,description:"",name:"keys",required:!0,type:{name:"string[]"}},onKeyPress:{defaultValue:null,description:"",name:"onKeyPress",required:!0,type:{name:"(key: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Controls/Controls.tsx#Controls"]={docgenInfo:Controls_Controls.__docgenInfo,name:"Controls",path:"src/components/Controls/Controls.tsx#Controls"})}catch(__react_docgen_typescript_loader_error){}class MessageBox_MessageBox extends react.Component{constructor(){super(...arguments),this.messages=services.ez.messages,this.messageNumber=void 0,this.renderMessage=(messageRecord,number)=>{let messageNumber="000".concat(number).slice(-3);return(0,jsx_runtime.jsxs)("li",{className:"message-level-".concat(messageRecord.level),children:[(0,jsx_runtime.jsx)("span",{className:"message-number",children:messageNumber+" "}),(0,jsx_runtime.jsx)("span",{className:"message-timestamp",children:messageRecord.timestamp+" "}),(0,jsx_runtime.jsx)("span",{className:"message-text",children:messageRecord.message})]},"msg".concat(number))}}shouldComponentUpdate(){return this.messages.length!==this.messageNumber}render(){if(!this.messages.length)return null;let RenderedMessages=this.messages.map((message,number)=>this.renderMessage(message,number));return this.messageNumber=this.messages.length,(0,jsx_runtime.jsx)("ul",{className:"messages",id:"messages",children:RenderedMessages})}scrollElement(){window.requestAnimationFrame(()=>{let element=document.getElementById("messages");element.scrollTop=element.scrollHeight})}componentDidUpdate(){this.messages.length&&this.scrollElement()}}try{MessageBox_MessageBox.displayName="MessageBox",MessageBox_MessageBox.__docgenInfo={description:"",displayName:"MessageBox",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MessageBox/MessageBox.tsx#MessageBox"]={docgenInfo:MessageBox_MessageBox.__docgenInfo,name:"MessageBox",path:"src/components/MessageBox/MessageBox.tsx#MessageBox"})}catch(__react_docgen_typescript_loader_error){}var InventoryItem=__webpack_require__("./src/components/InventoryItem/InventoryItem.tsx");function InventoryList_InventoryList(props){var _props$inventory,_props$inventory2;let baseClassName="inventory-list",[isExpanded,setIsExpanded]=(0,react.useState)(!0),finalClassName="\n    ".concat(baseClassName," ").concat(baseClassName).concat(isExpanded?"--expanded":"--collapsed"," ").concat(props.className||"","\n  "),inventoryItems=null===(_props$inventory=props.inventory)||void 0===_props$inventory?void 0:_props$inventory.map(item=>(0,jsx_runtime.jsx)(InventoryItem.R,{item:item,interactButtonText:props.interactButtonText,shorterDisplay:props.shorterDisplay,onInteract:props.onInteract,onDrop:props.onDrop,onReload:props.onReload,processInterface:props.processInterface},"i".concat(item.name))),componentClassName="inventory-list";return(0,jsx_runtime.jsxs)("div",{className:finalClassName,children:[props.label&&(0,jsx_runtime.jsx)("div",{className:"".concat(componentClassName,"__label"),children:props.label}),props.onClose&&(0,jsx_runtime.jsx)("button",{onClick:props.onClose,className:"\n            ".concat(componentClassName,"__button\n            ").concat(componentClassName,"__button-close\n          "),children:"X"}),(0,jsx_runtime.jsxs)("div",{className:"".concat(componentClassName,"__items"),title:props.title,children:[inventoryItems,(null===(_props$inventory2=props.inventory)||void 0===_props$inventory2?void 0:_props$inventory2.length)>0?null:props.label&&(0,jsx_runtime.jsx)("span",{className:"is-empty",children:"is empty"})]})]})}try{InventoryList_InventoryList.displayName="InventoryList",InventoryList_InventoryList.__docgenInfo={description:"",displayName:"InventoryList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},interactButtonText:{defaultValue:null,description:"",name:"interactButtonText",required:!0,type:{name:"string"}},onInteract:{defaultValue:null,description:"",name:"onInteract",required:!1,type:{name:"(itemName: string) => any"}},onDrop:{defaultValue:null,description:"",name:"onDrop",required:!1,type:{name:"(itemName: string) => any"}},onReload:{defaultValue:null,description:"",name:"onReload",required:!1,type:{name:"(weapon: RangedWeapon) => any"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"() => any"}},inventory:{defaultValue:null,description:"",name:"inventory",required:!1,type:{name:"Item[]"}},shorterDisplay:{defaultValue:null,description:"",name:"shorterDisplay",required:!1,type:{name:"boolean"}},processInterface:{defaultValue:null,description:"",name:"processInterface",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/InventoryList/InventoryList.tsx#InventoryList"]={docgenInfo:InventoryList_InventoryList.__docgenInfo,name:"InventoryList",path:"src/components/InventoryList/InventoryList.tsx#InventoryList"})}catch(__react_docgen_typescript_loader_error){}class HpBar_HpBar extends react.Component{render(){if(this.props.current<=0)return null;let percentage=~~(100*this.props.current/this.props.max),progressStyle={width:"".concat(percentage,"%"),backgroundColor:this.props.color};return(0,jsx_runtime.jsxs)("div",{className:"hpbar",children:[(0,jsx_runtime.jsx)("div",{className:"hpbar__indicator",style:progressStyle}),(0,jsx_runtime.jsx)("span",{className:"hpbar__text",children:this.props.current})]})}}try{HpBar_HpBar.displayName="HpBar",HpBar_HpBar.__docgenInfo={description:"",displayName:"HpBar",props:{current:{defaultValue:null,description:"",name:"current",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},color:{defaultValue:null,description:"",name:"color",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/HpBar/HpBar.tsx#HpBar"]={docgenInfo:HpBar_HpBar.__docgenInfo,name:"HpBar",path:"src/components/HpBar/HpBar.tsx#HpBar"})}catch(__react_docgen_typescript_loader_error){}function ShootingVisualization_ShootingVisualization(_ref){let{targetPosition,position,weaponType,actionId,runningTimeInMs=1e3,numberOfProjectiles=10,varianceBase=7}=_ref,calcNewAangle=Helpers.QN,projectileNumber=numberOfProjectiles,projectiles=[],localId="Entity-x".concat(position.x,"-y").concat(position.y,"-tx").concat(targetPosition.x,"-ty").concat(targetPosition.y,"-aid").concat(actionId),uniqueShootingAnimationId="shooting-animation-".concat(localId),customStyle="",commonStyles="",runningTime=null!=runningTimeInMs?runningTimeInMs:1e3;if(targetPosition&&position&&(targetPosition.x!==position.x||targetPosition.y!==position.y)&&targetPosition){let distanceToTargetXInUnits=targetPosition.x-position.x,distanceToTargetYInUnits=targetPosition.y-position.y,actualDistanceInUnits=Helpers.cL(distanceToTargetXInUnits,distanceToTargetYInUnits),angle=calcNewAangle(distanceToTargetXInUnits,distanceToTargetYInUnits);if(commonStyles="\n      @keyframes fading".concat(uniqueShootingAnimationId," {\n        0%  {opacity: 1;}\n        90% {opacity: 1;}\n        100%  {opacity: 0;}\n      }\n      ").concat(runningTime>=0?"\n          .fading-after-".concat(runningTime,"ms-for-").concat(uniqueShootingAnimationId," {\n              animation: fading").concat(uniqueShootingAnimationId," ").concat(runningTime,"ms linear normal forwards 1;\n          }"):"","\n      "),weaponType===services.vD.energy){let beamClassName="projectile".concat(localId,"_beam");customStyle="\n          @keyframes pulsing".concat(localId," {\n            0%  {opacity: 0.1;}\n            100%  {opacity: 1;}\n          }\n\n          @keyframes elongating").concat(localId," {\n            0%  { width: calc(").concat(actualDistanceInUnits,"em + ").concat(actualDistanceInUnits," * 4px - 20px); }\n            100%  {width: calc(").concat(actualDistanceInUnits,"em + ").concat(actualDistanceInUnits," * 4px - 20px); }\n          }\n\n          @keyframes swiping").concat(localId," {\n            0%  {transform: rotate(").concat(angle+90-1,"deg) translateX(").concat(20,"px);}\n            50%  {transform: rotate(").concat(angle+90+1,"deg) translateX(").concat(20,"px);}\n            100%  {transform: rotate(").concat(angle+90-1,"deg) translateX(").concat(20,"px);}\n          }\n\n          .").concat(beamClassName," {\n            width: ").concat(actualDistanceInUnits,"em;\n            height: 3px;\n            border-radius: 5px;\n            background: #F00;\n            position: absolute;\n            top: 0.5em;\n            left: 0.5em;\n            transform: rotate(").concat(angle+90,"deg);/* overriden by swiping keyframes */\n            transform-origin: left 0px;\n            animation: pulsing").concat(localId," 0.1s ease infinite,\n            elongating").concat(localId," 0.7s ease alternate infinite,\n            swiping").concat(localId," 1s ease alternate infinite;\n            box-shadow: 0 0 5px 5px white;\n            z-index: 10;\n          }\n          "),projectiles.push((0,jsx_runtime.jsx)("div",{className:beamClassName,children:""},beamClassName))}else{for(;projectileNumber--;){let targetVarianceX=Math.random()*varianceBase-varianceBase/2,targetVarianceY=Math.random()*varianceBase-varianceBase/2;customStyle+="\n          @keyframes shooting".concat(localId,"_").concat(projectileNumber," {\n            0%   {transform: translate(0,0) rotate(").concat(angle,"deg) scaleY(1)}\n            100% {transform: translate(\n              ").concat(40*(targetPosition.x-position.x)+targetVarianceX,"px,\n              ").concat(40*(targetPosition.y-position.y)+targetVarianceY,"px\n            ) rotate(").concat(angle,"deg) scaleY(1)}\n          }\n          ")+"\n          .projectile".concat(localId,"_").concat(projectileNumber," {\n            transform: rotateZ(").concat(angle,"deg);\n            animation: shooting").concat(localId,"_").concat(projectileNumber," 0.8s linear infinite;\n            animation-delay: ").concat(.2*projectileNumber,"s;\n          }")}for(projectileNumber=numberOfProjectiles;projectileNumber--;){let className="projectile projectile".concat(localId,"_").concat(projectileNumber);projectiles.push((0,jsx_runtime.jsx)("div",{className:className,children:"."},className))}}}let finalClassName="shooting-visualization fading-after-".concat(runningTime,"ms-for-").concat(uniqueShootingAnimationId);return(0,jsx_runtime.jsxs)("div",{className:finalClassName,children:[(0,jsx_runtime.jsx)("style",{children:customStyle+commonStyles}),projectiles]})}try{ShootingVisualization_ShootingVisualization.displayName="ShootingVisualization",ShootingVisualization_ShootingVisualization.__docgenInfo={description:"Displays a shooting attack visualization",displayName:"ShootingVisualization",props:{targetPosition:{defaultValue:null,description:"Position of a target square in a grid",name:"targetPosition",required:!0,type:{name:"Position"}},position:{defaultValue:null,description:"Position of a source square in a grid",name:"position",required:!0,type:{name:"Position"}},weaponType:{defaultValue:null,description:"Type of a weapon",name:"weaponType",required:!0,type:{name:"enum",value:[{value:'"projectile"'},{value:'"energy"'}]}},actionId:{defaultValue:null,description:"Unique number of this action - used to ensure each attack has a separate animation",name:"actionId",required:!0,type:{name:"number"}},runningTimeInMs:{defaultValue:{value:"1000"},description:"Time to run the visualization animation, in milliseconds. 0 to not run at all, -1 to run infinitely",name:"runningTimeInMs",required:!1,type:{name:"number"}},numberOfProjectiles:{defaultValue:{value:"10"},description:"Number of shots when it's a projectile weapon",name:"numberOfProjectiles",required:!1,type:{name:"number"}},varianceBase:{defaultValue:{value:"7"},description:"Spread of bullets on target, in pixels",name:"varianceBase",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ShootingVisualization/ShootingVisualization.tsx#ShootingVisualization"]={docgenInfo:ShootingVisualization_ShootingVisualization.__docgenInfo,name:"ShootingVisualization",path:"src/components/ShootingVisualization/ShootingVisualization.tsx#ShootingVisualization"})}catch(__react_docgen_typescript_loader_error){}var SlideInPanel=__webpack_require__("./src/components/SlideInPanel/SlideInPanel.tsx");let GradientBolt_GradientBolt=_ref=>{let{lineOfFireLength="20em",version=0,boltFlightTimeInHundredsOfMs=10}=_ref;return(0,jsx_runtime.jsx)("div",{className:"line-of-fire",style:{width:lineOfFireLength},children:(0,jsx_runtime.jsx)("div",{className:"bolt shooting version-".concat(version),style:{animationDuration:"".concat(100*boltFlightTimeInHundredsOfMs,"ms")}})})};try{GradientBolt_GradientBolt.displayName="GradientBolt",GradientBolt_GradientBolt.__docgenInfo={description:"A bolt rendered from a single div with a gradient",displayName:"GradientBolt",props:{version:{defaultValue:{value:"0"},description:"Number of the version of the bolt. 0-7",name:"version",required:!1,type:{name:"number"}},lineOfFireLength:{defaultValue:{value:"20em"},description:"Length of the line of fire in any CSS units",name:"lineOfFireLength",required:!1,type:{name:"string"}},boltFlightTimeInHundredsOfMs:{defaultValue:{value:"10"},description:"Time the bolt will take to travel and vanish from the line of fire (with tail)",name:"boltFlightTimeInHundredsOfMs",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GradientBolt/GradientBolt.tsx#GradientBolt"]={docgenInfo:GradientBolt_GradientBolt.__docgenInfo,name:"GradientBolt",path:"src/components/GradientBolt/GradientBolt.tsx#GradientBolt"})}catch(__react_docgen_typescript_loader_error){}function CursorMessage_CursorMessage(_ref){let{messageText="!",messageTimeInMs=1e3,messageColor="#eee"}=_ref;return(0,jsx_runtime.jsx)("div",{className:"cursor-message",style:{color:messageColor,animation:"fade-out ".concat(messageTimeInMs,"ms linear forwards")},children:messageText})}try{CursorMessage_CursorMessage.displayName="CursorMessage",CursorMessage_CursorMessage.__docgenInfo={description:"",displayName:"CursorMessage",props:{messageText:{defaultValue:{value:"!"},description:"",name:"messageText",required:!1,type:{name:"string"}},messageTimeInMs:{defaultValue:{value:"1000"},description:"",name:"messageTimeInMs",required:!1,type:{name:"number"}},messageColor:{defaultValue:{value:"#eee"},description:"",name:"messageColor",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/CursorMessage/CursorMessage.tsx#CursorMessage"]={docgenInfo:CursorMessage_CursorMessage.__docgenInfo,name:"CursorMessage",path:"src/components/CursorMessage/CursorMessage.tsx#CursorMessage"})}catch(__react_docgen_typescript_loader_error){}let BorderStyle=function(BorderStyle){return BorderStyle.solid="solid",BorderStyle.dashed="dashed",BorderStyle.dotted="dotted",BorderStyle}({});function FancyButton_FancyButton(_ref){let{title,children,className,width,height,textColor,textColorHover,textColorActive,backgroundColor,backgroundColorHover,backgroundColorActive,sideBorderColor,sideBorderColorHover,sideBorderColorActive,shadowColor,shadowColorHover,shadowColorActive,sideBorderStyle=BorderStyle.dashed,sideBorderWidthInPixels}=_ref,finalClassName="\n    ".concat("fancy-button"," \n    ").concat(className||"","\n  "),dynamicStyle={width,height,...{"--text-color":textColor,"--text-color--hover":textColorHover,"--text-color--active":textColorActive,"--background-color":backgroundColor,"--background-color--hover":backgroundColorHover,"--background-color--active":backgroundColorActive,"--shadow-color":shadowColor,"--shadow-color--hover":shadowColorHover,"--shadow-color--active":shadowColorActive,"--side-border-color":sideBorderColor,"--side-border-color--hover":sideBorderColorHover,"--side-border-color--active":sideBorderColorActive,"--side-border-style":sideBorderStyle,...sideBorderWidthInPixels&&{"--side-border-width":"".concat(sideBorderWidthInPixels,"px")}}};return(0,jsx_runtime.jsx)("div",{className:finalClassName,title:title,style:dynamicStyle,children:children||"Primary Activation Taster"})}try{FancyButton_FancyButton.displayName="FancyButton",FancyButton_FancyButton.__docgenInfo={description:"A panel that slides in from the right",displayName:"FancyButton",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"string"}},textColor:{defaultValue:null,description:"",name:"textColor",required:!1,type:{name:"string"}},textColorHover:{defaultValue:null,description:"",name:"textColorHover",required:!1,type:{name:"string"}},textColorActive:{defaultValue:null,description:"",name:"textColorActive",required:!1,type:{name:"string"}},backgroundColor:{defaultValue:null,description:"",name:"backgroundColor",required:!1,type:{name:"string"}},backgroundColorHover:{defaultValue:null,description:"",name:"backgroundColorHover",required:!1,type:{name:"string"}},backgroundColorActive:{defaultValue:null,description:"",name:"backgroundColorActive",required:!1,type:{name:"string"}},shadowColor:{defaultValue:null,description:"",name:"shadowColor",required:!1,type:{name:"string"}},shadowColorHover:{defaultValue:null,description:"",name:"shadowColorHover",required:!1,type:{name:"string"}},shadowColorActive:{defaultValue:null,description:"",name:"shadowColorActive",required:!1,type:{name:"string"}},sideBorderColor:{defaultValue:null,description:"",name:"sideBorderColor",required:!1,type:{name:"string"}},sideBorderColorHover:{defaultValue:null,description:"",name:"sideBorderColorHover",required:!1,type:{name:"string"}},sideBorderColorActive:{defaultValue:null,description:"",name:"sideBorderColorActive",required:!1,type:{name:"string"}},sideBorderWidthInPixels:{defaultValue:null,description:"",name:"sideBorderWidthInPixels",required:!1,type:{name:"number"}},sideBorderStyle:{defaultValue:{value:"BorderStyle.dashed"},description:"",name:"sideBorderStyle",required:!1,type:{name:"enum",value:[{value:'"solid"'},{value:'"dashed"'},{value:'"dotted"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/FancyButton/FancyButton.tsx#FancyButton"]={docgenInfo:FancyButton_FancyButton.__docgenInfo,name:"FancyButton",path:"src/components/FancyButton/FancyButton.tsx#FancyButton"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("./src/components/InfoPanel/index.ts")}}]);