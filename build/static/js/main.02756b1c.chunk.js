(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],[,,,,,,function(e,t,n){e.exports={game:"Game_game__229bL",game__board:"Game_game__board__1KMto",game__list:"Game_game__list__yMHF0",button:"Game_button__1_Ze4",actions:"Game_actions__2-VcJ","auto-cycle":"Game_auto-cycle__1cp6W",next_tick:"Game_next_tick__W3YYp",execute_actions:"Game_execute_actions__OuWzh",nuke:"Game_nuke__23ZLU",game__info:"Game_game__info__3kjt8",action_row:"Game_action_row__1mTrg","interaction-container":"Game_interaction-container__3RZ7s",selected:"Game_selected__ZRNAo",targeted:"Game_targeted__3gJqr",selected__label:"Game_selected__label__2d30g",targeted__label:"Game_targeted__label__328kg","step-counter":"Game_step-counter__hrmzE",status:"Game_status__21KP9","kbd-navigation":"Game_kbd-navigation__10pCT",square:"Game_square__3r5qO"}},,,function(e,t,n){e.exports={board:"Board_board__1AthT",board__row:"Board_board__row__1piKV","board--rotated":"Board_board--rotated__be1H9"}},,,function(e){e.exports=JSON.parse('[{"id":0,"name":"","squareType":"floor","position":{"x":0,"y":0}},{"id":1,"name":"","squareType":"floor","position":{"x":1,"y":0}},{"id":2,"name":"","squareType":"floor","position":{"x":2,"y":0}},{"id":3,"name":"","squareType":"floor","position":{"x":3,"y":0}},{"id":4,"name":"","squareType":"floor","position":{"x":4,"y":0}},{"id":5,"name":"","squareType":"floor","position":{"x":5,"y":0}},{"id":6,"name":"","squareType":"floor","position":{"x":6,"y":0}},{"id":7,"name":"","squareType":"floor","position":{"x":7,"y":0}},{"id":8,"name":"","squareType":"floor","position":{"x":8,"y":0}},{"id":9,"name":"","squareType":"floor","position":{"x":9,"y":0}},{"id":10,"name":"Teleport to SW Corner","description":"Moves you to 0,9","icon":"\u2b07\ufe0f","squareType":"floor","position":{"x":0,"y":1}},{"id":11,"name":"","squareType":"wall","position":{"x":1,"y":1}},{"id":12,"name":"","squareType":"wall","position":{"x":2,"y":1}},{"id":13,"name":"","squareType":"wall","position":{"x":3,"y":1}},{"id":14,"name":"","squareType":"floor","position":{"x":4,"y":1}},{"id":15,"name":"","squareType":"wall","position":{"x":5,"y":1}},{"id":16,"name":"","squareType":"wall","position":{"x":6,"y":1}},{"id":17,"name":"","squareType":"floor","position":{"x":7,"y":1}},{"id":18,"name":"","squareType":"floor","position":{"x":8,"y":1}},{"id":19,"name":"","squareType":"floor","position":{"x":9,"y":1}},{"id":20,"name":"","squareType":"wall","position":{"x":0,"y":2}},{"id":21,"name":"","squareType":"wall","position":{"x":1,"y":2}},{"id":22,"name":"","squareType":"floor","position":{"x":2,"y":2}},{"id":23,"name":"","squareType":"wall","position":{"x":3,"y":2}},{"id":24,"name":"","squareType":"floor","position":{"x":4,"y":2}},{"id":25,"name":"","squareType":"wall","position":{"x":5,"y":2}},{"id":26,"name":"","squareType":"floor","position":{"x":6,"y":2}},{"id":27,"name":"","squareType":"floor","position":{"x":7,"y":2}},{"id":28,"name":"","squareType":"floor","position":{"x":8,"y":2},"entity":{"bleedingReductionPerTurn":0,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Octo","hp":200,"maxHp":200,"icon":"\ud83d\udc19","position":{"x":8,"y":2},"bleeding":1,"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}},"entities":[{"bleedingReductionPerTurn":0,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Octo","hp":200,"maxHp":200,"icon":"\ud83d\udc19","position":{"x":8,"y":2},"bleeding":1,"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}}]},{"id":29,"name":"","squareType":"floor","position":{"x":9,"y":2}},{"id":30,"name":"","squareType":"floor","position":{"x":0,"y":3}},{"id":31,"name":"","squareType":"floor","position":{"x":1,"y":3}},{"id":32,"name":"","squareType":"floor","position":{"x":2,"y":3}},{"id":33,"name":"","squareType":"floor","position":{"x":3,"y":3}},{"id":34,"name":"","squareType":"floor","position":{"x":4,"y":3}},{"id":35,"name":"","squareType":"wall","position":{"x":5,"y":3}},{"id":36,"name":"","squareType":"floor","position":{"x":6,"y":3}},{"id":37,"name":"","squareType":"floor","position":{"x":7,"y":3}},{"id":38,"name":"","squareType":"floor","position":{"x":8,"y":3}},{"id":39,"name":"","squareType":"floor","position":{"x":9,"y":3},"entity":{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Henry The Spider","hp":100,"maxHp":150,"icon":"\ud83d\udd77\ufe0f","position":{"x":9,"y":3},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}},"entities":[{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Henry The Spider","hp":100,"maxHp":150,"icon":"\ud83d\udd77\ufe0f","position":{"x":9,"y":3},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}}]},{"id":40,"name":"","squareType":"floor","position":{"x":0,"y":4}},{"id":41,"name":"","squareType":"wall","position":{"x":1,"y":4}},{"id":42,"name":"","squareType":"wall","position":{"x":2,"y":4}},{"id":43,"name":"","squareType":"floor","position":{"x":3,"y":4}},{"id":44,"name":"","squareType":"floor","position":{"x":4,"y":4}},{"id":45,"name":"","squareType":"wall","position":{"x":5,"y":4}},{"id":46,"name":"","squareType":"floor","position":{"x":6,"y":4},"entity":{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":0,"maxActionPoints":2,"hasWeapon":true,"name":"Squid","hp":100,"maxHp":100,"icon":"\ud83e\udd91","position":{"x":6,"y":4},"equipment":{"hands":{"name":"M41A Pulse Rifle","causesBleeding":2,"range":4,"damage":1,"rounds":40,"maxRounds":40,"type":"projectile"}}},"entities":[{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":0,"maxActionPoints":2,"hasWeapon":true,"name":"Squid","hp":100,"maxHp":100,"icon":"\ud83e\udd91","position":{"x":6,"y":4},"equipment":{"hands":{"name":"M41A Pulse Rifle","causesBleeding":2,"range":4,"damage":1,"rounds":40,"maxRounds":40,"type":"projectile"}}}]},{"id":47,"name":"","squareType":"floor","position":{"x":7,"y":4}},{"id":48,"name":"","squareType":"floor","position":{"x":8,"y":4}},{"id":49,"name":"","squareType":"floor","position":{"x":9,"y":4}},{"id":50,"name":"","squareType":"floor","position":{"x":0,"y":5}},{"id":51,"name":"","squareType":"wall","position":{"x":1,"y":5}},{"id":52,"name":"","squareType":"floor","position":{"x":2,"y":5}},{"id":53,"name":"","squareType":"floor","position":{"x":3,"y":5},"entity":{"isFriendly":true,"bleedingReductionPerTurn":50,"isSupposedToBeBreathing":false,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Robot","age":1,"hp":50,"maxHp":50,"icon":"\ud83e\udd16","position":{"x":3,"y":5},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}},"entities":[{"isFriendly":true,"bleedingReductionPerTurn":50,"isSupposedToBeBreathing":false,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Robot","age":1,"hp":50,"maxHp":50,"icon":"\ud83e\udd16","position":{"x":3,"y":5},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}}]},{"id":54,"name":"","squareType":"floor","position":{"x":4,"y":5}},{"id":55,"name":"","squareType":"wall","position":{"x":5,"y":5}},{"id":56,"name":"","squareType":"floor","position":{"x":6,"y":5}},{"id":57,"name":"","squareType":"floor","position":{"x":7,"y":5}},{"id":58,"name":"","squareType":"wall","position":{"x":8,"y":5}},{"id":59,"name":"","squareType":"wall","position":{"x":9,"y":5}},{"id":60,"name":"","squareType":"floor","position":{"x":0,"y":6}},{"id":61,"name":"","squareType":"wall","position":{"x":1,"y":6}},{"id":62,"name":"","squareType":"wall","position":{"x":2,"y":6}},{"id":63,"name":"","squareType":"wall","position":{"x":3,"y":6}},{"id":64,"name":"","squareType":"wall","position":{"x":4,"y":6}},{"id":65,"name":"","squareType":"wall","position":{"x":5,"y":6}},{"id":66,"name":"","squareType":"floor","position":{"x":6,"y":6}},{"id":67,"name":"","squareType":"wall","position":{"x":7,"y":6}},{"id":68,"name":"","squareType":"wall","position":{"x":8,"y":6}},{"id":69,"name":"","squareType":"nothing","position":{"x":9,"y":6}},{"id":70,"name":"","squareType":"floor","position":{"x":0,"y":7}},{"id":71,"name":"","squareType":"floor","position":{"x":1,"y":7}},{"id":72,"name":"","squareType":"floor","position":{"x":2,"y":7},"entity":{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":1,"maxActionPoints":1,"hasWeapon":true,"name":"Mosquito","hp":12,"maxHp":20,"icon":"\ud83e\udd9f","position":{"x":2,"y":7},"equipment":{"hands":{"name":"M16","causesBleeding":2,"range":4,"damage":2,"rounds":15,"maxRounds":20,"type":"projectile"}}},"entities":[{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":1,"maxActionPoints":1,"hasWeapon":true,"name":"Mosquito","hp":12,"maxHp":20,"icon":"\ud83e\udd9f","position":{"x":2,"y":7},"equipment":{"hands":{"name":"M16","causesBleeding":2,"range":4,"damage":2,"rounds":15,"maxRounds":20,"type":"projectile"}}}]},{"id":73,"name":"","squareType":"floor","position":{"x":3,"y":7}},{"id":74,"name":"","squareType":"floor","position":{"x":4,"y":7}},{"id":75,"name":"","squareType":"wall","position":{"x":5,"y":7}},{"id":76,"name":"","squareType":"floor","position":{"x":6,"y":7}},{"id":77,"name":"","squareType":"wall","position":{"x":7,"y":7}},{"id":78,"name":"","squareType":"floor","position":{"x":8,"y":7},"entity":{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":0,"maxActionPoints":2,"hasWeapon":true,"name":"Ant","age":1,"hp":45,"maxHp":50,"icon":"\ud83d\udc1c","position":{"x":8,"y":7},"equipment":{"hands":{"name":"M41A Pulse Rifle","causesBleeding":2,"range":4,"damage":1,"rounds":40,"maxRounds":40,"type":"projectile"}}},"entities":[{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":0,"maxActionPoints":2,"hasWeapon":true,"name":"Ant","age":1,"hp":45,"maxHp":50,"icon":"\ud83d\udc1c","position":{"x":8,"y":7},"equipment":{"hands":{"name":"M41A Pulse Rifle","causesBleeding":2,"range":4,"damage":1,"rounds":40,"maxRounds":40,"type":"projectile"}}}]},{"id":79,"name":"","squareType":"floor","position":{"x":9,"y":7}},{"id":80,"name":"","squareType":"floor","position":{"x":0,"y":8}},{"id":81,"name":"","squareType":"floor","position":{"x":1,"y":8}},{"id":82,"name":"","squareType":"floor","position":{"x":2,"y":8}},{"id":83,"name":"","squareType":"floor","position":{"x":3,"y":8},"entity":{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Microbe","hp":1,"maxHp":5,"icon":"\ud83e\udda0","position":{"x":3,"y":8},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}},"entities":[{"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Microbe","hp":1,"maxHp":5,"icon":"\ud83e\udda0","position":{"x":3,"y":8},"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}}]},{"id":84,"name":"","squareType":"floor","position":{"x":4,"y":8}},{"id":85,"name":"Teleport to NW Corner","description":"Moves you to 0,0","icon":"\u2196\ufe0f","squareType":"floor","position":{"x":5,"y":8}},{"id":86,"name":"","squareType":"floor","position":{"x":6,"y":8},"isTargeted":true,"entity":{"isFriendly":true,"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Lazer Blady","hp":75,"maxHp":100,"icon":"\ud83e\uddd1\u200d\ud83d\ude80","position":{"x":6,"y":8},"inventory":[{"name":"M16","causesBleeding":2,"range":4,"damage":2,"rounds":15,"maxRounds":20,"type":"projectile"}],"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}},"entities":[{"isFriendly":true,"bleedingReductionPerTurn":1,"isSupposedToBeBreathing":true,"isPassable":false,"actionPoints":2,"maxActionPoints":2,"hasWeapon":true,"name":"Lazer Blady","hp":75,"maxHp":100,"icon":"\ud83e\uddd1\u200d\ud83d\ude80","position":{"x":6,"y":8},"inventory":[{"name":"M16","causesBleeding":2,"range":4,"damage":2,"rounds":15,"maxRounds":20,"type":"projectile"}],"equipment":{"hands":{"name":"Assault Lazer Cannon","causesBleeding":0,"range":6,"damage":3,"rounds":30,"maxRounds":30,"type":"lazer"}}}]},{"id":87,"name":"","squareType":"floor","position":{"x":7,"y":8}},{"id":88,"name":"EXIT","description":"Reach this place to win The Game","icon":"\ud83d\udeaa","squareType":"floor","position":{"x":8,"y":8}},{"id":89,"name":"","squareType":"floor","position":{"x":9,"y":8}},{"id":90,"name":"","squareType":"floor","position":{"x":0,"y":9}},{"id":91,"name":"","squareType":"floor","position":{"x":1,"y":9}},{"id":92,"name":"","squareType":"floor","position":{"x":2,"y":9}},{"id":93,"name":"","squareType":"floor","position":{"x":3,"y":9}},{"id":94,"name":"Healing Station","icon":"\ud83c\udfe5","description":"This advanced healing station repairs all damage done to a given entity","squareType":"floor","position":{"x":4,"y":9}},{"id":95,"name":"","squareType":"wall","position":{"x":5,"y":9}},{"id":96,"name":"","squareType":"floor","position":{"x":6,"y":9}},{"id":97,"name":"","squareType":"wall","position":{"x":7,"y":9}},{"id":98,"name":"","squareType":"floor","position":{"x":8,"y":9}},{"id":99,"name":"","squareType":"floor","position":{"x":9,"y":9}}]')},function(e,t,n){e.exports=n(35)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(11),s=n(1),r=n(2),c=n(4),l=n(3),u=n(5);function p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];e.forEach((function(e){n.forEach((function(t){e&&(e[t]=void 0)}))}))}function m(e,t,n){return e<t&&(e=t),e>n&&(e=n),e}function d(e,t){return Math.floor(Math.random()*(t-e+1))+e}function h(e,t){var n;return t>=0?n=-Math.atan(e/t)*(180/Math.PI):t<0&&(n=180/Math.PI*(Math.atan(e/-t)+Math.PI)),n}function y(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function f(e,t){if(!e)return"";var n={active:"active",isAvailableDestination:"is-available-destination",isChosenDestination:"is-chosen-destination",isBreathing:"breathing",isDead:"dead",isShooting:"shooting",isTargeted:"targeted",isAttacked:"attacked",isLit:"is-lit",isInTwilightZone:"is-in-twilight-zone"},a="";return t?t+="--":t="",Object.keys(n).forEach((function(i){e[i]&&(a+=" ".concat(t).concat(n[i]))})),a}function v(e){if(e){var t="".concat("square"," ").concat(e&&e.squareType);return t+=f(e,"square"),e.entity&&(t+=f(e.entity,"square")),t}}var g,b=n(9),x=n.n(b),E=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){console.log("Handles Click on Board",e),n.props.onClick(e)},n.EntityPawns=function(){return n.props.entities.map((function(e){return i.a.createElement(re,{key:e.name,entity:e})}))},n.BoardSquares=function(){var e,t=0,a=0;return Array(n.props.size).fill(null).map((function(o,s){e=0;var r=Array(n.props.size).fill(null).map((function(i,o){return n.renderSquare(t++,a,e++)}));return i.a.createElement("div",{key:a++,className:x.a.board__row},r)}))},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"renderSquare",value:function(e,t,n){var a=this.props.squares[e];return i.a.createElement(ge,{key:"r".concat(t,"_c").concat(e),squareId:e,className:v(a),onClick:this.handleClick,blood:a&&a.blood,items:a&&a.items,itemsNumber:a&&a.items&&a.items.length})}},{key:"render",value:function(){var e=x.a.board;return this.props.isRotated&&(e+=" ".concat(x.a["board--rotated"]," board--rotated")),i.a.createElement("div",{className:e,style:this.props.style},this.BoardSquares(),this.EntityPawns())}}]),t}(i.a.Component),q=(n(18),i.a.Component,n(8)),k=function e(){Object(s.a)(this,e),this.id=void 0,this.name="",this.icon=" "},O=function(){function e(){Object(s.a)(this,e),this.position={x:void 0,y:void 0},this.isPassable=!1}return Object(r.a)(e,[{key:"isBlocking",get:function(){return!this.isPassable}},{key:"square",get:function(){return I.getSquareFromPosition(this.position.x,this.position.y)}}]),e}(),S=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).moveDestination=void 0,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"setMoveDestinationSquareByNumber",value:function(e){this.setMoveDestinationPosition(I.getSquarePositionFromIndex(e))}},{key:"setMoveDestinationPosition",value:function(e){var t=I.getSquareFromPosition(e.x,e.y),n=I.getSquareIndexFromPosition(e.x,e.y);I.isTargetSquareEnterable(t)?(this.moveDestination=e,I.markSquareAtIndexAsChosenDestination(n)):z.send("".concat(this.name," can't move into square (").concat(e.x,", ").concat(e.y,")"))}}]),t}(k),j=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).hp=100,n.maxHp=100,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"isDead",get:function(){return!this.isAlive}},{key:"isAlive",get:function(){return this.hp>0}}]),t}(O),P=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).bleeding=0,n.bleedingReductionPerTurn=1,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"bleed",value:function(){var e=0;return this.bleeding&&this.isAlive&&(e=this.bleeding,this.hp-=e,this.bleeding-=this.bleedingReductionPerTurn,this.bleeding<0&&(this.bleeding=0)),e}},{key:"bleedExternally",value:function(){if(this.bleeding){var e=this.bleed(),t=I.getSquareFromPosition(this.position.x,this.position.y);I.addBloodToSquare(t,e)}}}]),t}(j),A=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).isSupposedToBeBreathing=void 0,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"isBreathing",get:function(){return this.isAlive&&this.isSupposedToBeBreathing},set:function(e){this.isSupposedToBeBreathing=e}}]),t}(j),T=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).targetPosition=void 0,n.isShooting=void 0,n.ceaseFire=void 0,n.hasWeapon=void 0,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"attackPosition",value:function(e){this.hasWeapon?(this.targetPosition=e,this.ceaseFire=!1):z.send("".concat(this.name," can't shoot - no weapon equipped")),console.log(this.name,"is attacking",e,this)}}]),t}(k),w=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).inventory=void 0,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"takeFromInventory",value:function(e){this.inventory||(this.inventory=[]);var t=this.inventory.findIndex((function(t){return t.name===e}));return-1===t?null:this.inventory.splice(t,1)[0]}},{key:"addToInventory",value:function(e){this.inventory||(this.inventory=[]),this.inventory.push(e)}}]),t}(k),_=function e(){Object(s.a)(this,e),this.isFriendly=void 0,this.active=void 0;for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];Object.assign.apply(Object,[this].concat(n))};g=_,[k,O,j,P,S,A,T,w,function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).equipment=void 0,n.hasWeapon=void 0,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"equipInHands",value:function(e){this.unEquipFromHands();var t=this.takeFromInventory(e);this.equipment.hands=t,this.hasWeapon=t instanceof D}},{key:"unEquipFromHands",value:function(){this.equipment.hands&&(this.addToInventory(this.equipment.hands),this.equipment.hands=null,this.hasWeapon=!1)}}]),t}(w),function e(){Object(s.a)(this,e),this.actionPoints=2,this.maxActionPoints=2}].forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(t){Object.defineProperty(g.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t))}))}));var N=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this))).squareType="nothing",n.id=e,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"addItem",value:function(e){this.addToInventory(e)}},{key:"items",get:function(){return this.inventory}}]),t}(w),I=new(function(){function e(){Object(s.a)(this,e),this.arenaSize=10,this.squares=[],this.isSquareEnterableByFriendlyUnits=function(e){return["floor","monster-filter"].includes(e.squareType)};for(var t=this.arenaSize*this.arenaSize;0!==t--;)this.initializeSquareAtIndexIfEmpty(t)}return Object(r.a)(e,[{key:"getSquareFromPosition",value:function(e,t){return this.squares[this.getSquareIndexFromPosition(e,t)]}},{key:"setSquareValueAtPosition",value:function(e,t,n){this.squares[this.getSquareIndexFromPosition(e,t)]=n}},{key:"getSquareIndexFromPosition",value:function(e,t){return t*this.arenaSize+e}},{key:"getSquarePositionFromIndex",value:function(e){var t;return t=Math.floor(e/this.arenaSize),{x:e%this.arenaSize,y:t}}},{key:"setEntityWithinApropriateSquare",value:function(e){this.setEntityWithinASquareAtPosition(e.position.x,e.position.y,e)}},{key:"setEntityWithinASquareAtPosition",value:function(e,t,n){var a=this.getSquareIndexFromPosition(e,t);this.initializeSquareAtIndexIfEmpty(a),this.squares[a].entity=n,Array.isArray(this.squares[a].entities)||(this.squares[a].entities=[]),this.squares[a].entities.push(n)}},{key:"addBloodToSquare",value:function(e,t){e.blood?e.blood+=t:e.blood=t}},{key:"markSquareAtIndexAsTargeted",value:function(e){p(this.squares,"isTargeted"),this.initializeSquareAtIndexIfEmpty(e),this.squares[e].isTargeted=!0}},{key:"markSquareAtIndexAsAttacked",value:function(e){p(this.squares,"isAttacked"),this.initializeSquareAtIndexIfEmpty(e),this.squares[e].isAttacked=!0}},{key:"markSquareAtIndexAsChosenDestination",value:function(e){p(this.squares,"isChosenDestination"),this.initializeSquareAtIndexIfEmpty(e),this.squares[e].isChosenDestination=!0}},{key:"initializeSquareAtIndexIfEmpty",value:function(e){this.squares[e]||(this.squares[e]=new N(e),this.squares[e].position=this.getSquarePositionFromIndex(e))}},{key:"markAvailableDestinationsForSelectedEntity",value:function(e){if(e.active){var t=e.position,n=t.x,a=t.y;p(this.squares,"isAvailableDestination");for(var i=a-1;i<=a+1;i++)if(!(i<0||i>=this.arenaSize))for(var o=n-1;o<=n+1;o++)if(!(o<0||o>=this.arenaSize||o===n&&i===a)){var s=this.getSquareFromPosition(o,i);this.isSquareEnterableByFriendlyUnits(s)&&(s.isAvailableDestination=!0),this.setSquareValueAtPosition(o,i,s)}}}},{key:"isTargetSquareEnterable",value:function(e){var t=e.entities&&e.entities.filter((function(e){return!e.isPassable&&e.isAlive}));return!(t&&t.length)}},{key:"lightAllSquares",value:function(){this.squares.forEach((function(e){return e.isLit=!0}))}},{key:"castLightsFromFriendlyEntity",value:function(e){if(e.isFriendly){for(var t=e.position,n=t.x,a=t.y,i=a-2;i<=a+2;i++)if(!(i<0||i>=this.arenaSize))for(var o=n-2;o<=n+2;o++)if(!(o<0||o>=this.arenaSize)){var s=this.getSquareFromPosition(o,i);s.isInTwilightZone=!0,this.setSquareValueAtPosition(o,i,s)}for(var r=a-1;r<=a+1;r++)if(!(r<0||r>=this.arenaSize))for(var c=n-1;c<=n+1;c++)if(!(c<0||c>=this.arenaSize)){var l=this.getSquareFromPosition(c,r);l.isLit=!0,this.setSquareValueAtPosition(c,r,l)}}}}]),e}()),C=new(function(){function e(){var t=this;Object(s.a)(this,e),this.entities=void 0,this.selected=void 0,this.shouldEntityStopShooting=function(e){return e.ceaseFire||e.isDead},this.stopShooting=function(e){return e.isShooting=!1,e.ceaseFire=!1},this.stopShootingWhenForbidden=function(e){t.shouldEntityStopShooting(e)&&t.stopShooting(e)}}return Object(r.a)(e,[{key:"getEntityId",value:function(e){return e.name}},{key:"findEntityById",value:function(e){var t=this;return this.entities.filter((function(n){return t.getEntityId(n)===e}))[0]}},{key:"removeEntity",value:function(e){var t=this.entities.findIndex((function(t){return t.name===e.name}));return-1===t?-1:(this.entities.splice(t,1),0)}},{key:"addEntity",value:function(e){this.entities.push(e)}},{key:"findItemOnEntity",value:function(e,t){var n=this;return e.inventory.filter((function(a){return n.getEntityId(e)===t}))[0]}},{key:"moveEntityRandomly",value:function(e){if(!e.isDead&&!e.isFriendly){var t=e.position.x,n=e.position.y,a=d(-1,1),i=d(-1,1);e.actionPoints||(a=0,i=0),(a||i)&&e.actionPoints--,e.position.x=e.position.x+a,e.position.y=e.position.y+i,e.position.x=m(e.position.x,0,9),e.position.y=m(e.position.y,0,9);var o=I.getSquareFromPosition(e.position.x,e.position.y);(o&&o.entity||o&&"floor"!==o.squareType)&&(e.position.x=t,e.position.y=n)}}},{key:"stopBreathingForKilledEntity",value:function(e){return e.isDead&&(e.isBreathing=!1,this.stopShooting(e),e.hp=0),e}},{key:"getEntitiesAtGivenPosition",value:function(e){return this.entities.filter((function(t){return t.position.x===e.x&&t.position.y===e.y}))}},{key:"getEntitiesAtGivenPositionThatAreAlive",value:function(e){return this.getEntitiesAtGivenPosition(e).filter((function(e){return e.isAlive}))}},{key:"selectEntityFromGivenSquare",value:function(e,t){return e&&t&&t.entity&&(e.active=!1),t&&t.entity&&((e=t.entity).active=!0),e}},{key:"setSelected",value:function(e,t){return this.selected=e,e.active=t,t||(this.selected=null,console.log("Deselected:",e)),e}},{key:"checkAmmoAndCalculateDamageApplied",value:function(e){var t=0,n=void 0,a=e.equipment&&e.equipment.hands;return a instanceof R?(n=a).isAbleToFire?(t=n.fire(),e.isShooting=!0,e.actionPoints--,t):(n.rounds="empty",this.stopShooting(e),0):0}},{key:"fireAShot",value:function(e){var t=this;if(e.actionPoints&&!e.isDead){var n=this.checkAmmoAndCalculateDamageApplied(e);this.getEntitiesAtGivenPosition(e.targetPosition).forEach((function(e){t.applyDamageToTargetEntity(e,n)}))}}},{key:"applyDamageToTargetEntity",value:function(e,t){t&&(e.hp-=t,e.bleeding=5)}},{key:"ceaseFireNextTickIfNoAliveTargets",value:function(e){e.targetPosition&&(!!C.getEntitiesAtGivenPositionThatAreAlive(e.targetPosition).length||(e.ceaseFire=!0))}},{key:"isEntityTargettingSomethingAlive",value:function(e){var t=e.targetPosition&&!!C.getEntitiesAtGivenPositionThatAreAlive(e.targetPosition).length;return e.targetPosition&&(e.targetPosition.x!==e.position.x||e.targetPosition.y!==e.position.y)&&t}},{key:"applyEffectsOfBleeding",value:function(e){return e.bleedExternally(),e}},{key:"moveEntityIntoChosenDestination",value:function(e){if(!e.actionPoints)return e;if(!e.isDead&&e.moveDestination){var t=I.getSquareFromPosition(e.moveDestination.x,e.moveDestination.y);e.position=e.moveDestination,delete e.moveDestination,t.isChosenDestination=void 0,e.actionPoints--}return e}},{key:"setMoveDestinationOnASelectedEntity",value:function(e,t){e.moveDestination=t}},{key:"moveEntities",value:function(){var e=this;this.entities.filter((function(e){return!e.isFriendly})).forEach((function(t){e.moveEntityRandomly(t)}))}},{key:"refillActionPointsForAllEntities",value:function(){this.entities.forEach((function(e){e.actionPoints=e.maxActionPoints}))}}]),e}()),B=function e(){Object(s.a)(this,e),this.name=""},D=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).causesBleeding=0,n.range=0,n.damage=0,n}return Object(u.a)(t,e),t}(B),R=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).rounds=0,n.maxRounds=5,n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"fire",value:function(){return this.rounds--,console.log("Firing ranged weapon. Damage: ",this.damage),this.damage}},{key:"reload",value:function(){this.rounds=this.maxRounds}},{key:"isAbleToFire",get:function(){return this.rounds>0}}]),t}(D),F=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).type="projectile",n.range=4,n.damage=1,n.causesBleeding=2,n}return Object(u.a)(t,e),t}(R),M=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).type="lazer",n.range=6,n.damage=5,n.causesBleeding=0,n}return Object(u.a)(t,e),t}(R),z=new(function(){function e(){Object(s.a)(this,e),this.messages=[]}return Object(r.a)(e,[{key:"send",value:function(e){this.messages.push(e)}}]),e}()),L=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).name="\ud83d\udd2bM16",n.rounds=15,n.maxRounds=20,n.damage=2,n}return Object(u.a)(t,e),t}(F),H=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).name="\ud83d\udc7dM41A Pulse Rifle",n.rounds=40,n.maxRounds=40,n.damage=1,n}return Object(u.a)(t,e),t}(F),G=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).name="\u2600\ufe0fAssault Lazer Cannon",n.rounds=30,n.maxRounds=30,n.damage=3,n}return Object(u.a)(t,e),t}(M);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var K,Y=[{name:"Lazer Blady",hp:75,maxHp:100,icon:"\ud83e\uddd1\u200d\ud83d\ude80",isFriendly:!0,position:{x:6,y:8},inventory:[new L],equipment:{hands:new G}},{name:"Robot",age:1,hp:50,maxHp:50,icon:"\ud83e\udd16",isFriendly:!0,isBreathing:!1,position:{x:3,y:5},equipment:{hands:new G},bleedingReductionPerTurn:50},{name:"Octo",hp:200,maxHp:200,icon:"\ud83d\udc19",position:{x:8,y:2},bleedingReductionPerTurn:0,bleeding:1,equipment:{hands:new G}},{name:"Squid",hp:100,maxHp:100,icon:"\ud83e\udd91",position:{x:5,y:5},equipment:{hands:new H}},{name:"Ant",age:1,hp:45,maxHp:50,icon:"\ud83d\udc1c",isBreathing:!0,position:{x:7,y:6},equipment:{hands:new H}},{name:"Henry The Spider",hp:100,maxHp:150,icon:"\ud83d\udd77\ufe0f",position:{x:9,y:3},equipment:{hands:new G}},{name:"Mosquito",hp:12,maxHp:20,icon:"\ud83e\udd9f",position:{x:2,y:7},equipment:{hands:new L},actionPoints:1,maxActionPoints:1},{name:"Microbe",hp:1,maxHp:5,icon:"\ud83e\udda0",position:{x:3,y:8},equipment:{hands:new G}}],U={bleedingReductionPerTurn:1,isBreathing:!0,isPassable:!1,actionPoints:2,maxActionPoints:2,hasWeapon:!0},X=function(e){return Object.assign(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){Object(q.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},U),e)},J=Y.map((function(e){return X(e)})).map((function(e){return new _(e)})),Z=n(12),V={box:{name:"box",icon:"\ud83d\udce6",hp:50,maxHp:70,isBreathing:!1,isPassable:!1,position:{x:4,y:5}},redBarrel:{name:"redBarrel",icon:"\ud83d\udee2\ufe0f",hp:50,maxHp:70,isBreathing:!1,isPassable:!0,position:{x:4,y:5}}},$=new function e(){var t=this;Object(s.a)(this,e),this.entities=void 0,this.squares=void 0,this.selected=void 0,this.saveMap=function(){console.log("Alive suares:",I.squares);var e=JSON.parse(JSON.stringify(I.squares)).map((function(e){return e})),t=JSON.stringify(e);console.log(t);var n=window.prompt("Enter the name of saved map.","map00");localStorage[n]=t},this.loadMap=function(e){var n=Object.keys(localStorage),a="Enter the name of map to load.\n"+"Maps available in localStorage: ".concat(n,"\n")+"Be aware item processing is not working fully yet.";console.log(n);var i=window.prompt(a,n),o=localStorage[i];console.log(o);var s=JSON.parse(o);t.loadSquaresIntoService(s);var r=s.filter((function(e){return e.entity})).map((function(e){return e.entity}));function c(e){return new G}console.log("Entities Within The Map:",r);var l=r.map((function(e){return(t=e).equipment&&t.equipment.hands&&(t.equipment.hands=c(t.equipment.hands)),t.inventory&&t.inventory.map((function(e){return c()})),t;var t})).map((function(e){return new _(e)}));console.log("ALIVE ENTITIES?",l),t.loadEntitiesIntoService(l),e.setSquaresAccordingToEntities(),e.processInterface()},this.loadSquaresIntoService=function(e){I.squares.forEach((function(t,n){var a=t,i=e[n];a.squareType=i&&i.squareType||"floor",a.icon=i&&i.icon||" ",a.name=i&&i.name||" ",a.description=i&&i.description||" "}))},this.loadEntitiesIntoService=function(e){C.entities=e},this.loadBuiltInMap=function(){t.loadSquaresIntoService(Z)},this.loadPredefinedEntitities=function(){t.loadEntitiesIntoService(J)},this.entities=C.entities,this.squares=I.squares};!function(e){e.entityPresent="entity-present",e.allEntitiesDead="all-entities-dead"}(K||(K={}));var Q=new(function(){function e(){var t=this;Object(s.a)(this,e),this.scripts=[{what:K.entityPresent,where:{x:8,y:8},who:"Lazer Blady",condition:"alive",params:[],result:{action:"message",params:["You have reached the exit. You have won the game."]}},{what:K.entityPresent,where:{x:6,y:8},who:"Lazer Blady",condition:"alive",params:[],result:{action:"load-map",params:["A2"]}},{what:K.entityPresent,where:{x:4,y:9},condition:"alive",params:[],result:{action:"heal",params:[]}},{what:K.entityPresent,where:{x:5,y:8},condition:"alive",params:[],result:{action:"move",params:[{x:0,y:0}]}},{what:K.entityPresent,where:{x:0,y:1},result:{action:"move",params:[{x:0,y:9}]}}],this.runScripts=function(e){t.scripts.forEach((function(e){return t.runScript(e)}))},console.debug(JSON.stringify(this.scripts))}return Object(r.a)(e,[{key:"runScript",value:function(e){console.log("Running script.",e),this.isConditionFullfilled(e)&&this.executeResult(e)}},{key:"isConditionFullfilled",value:function(e){switch(e.what){case K.entityPresent:if(!e.where)break;var t=C.getEntitiesAtGivenPosition(e.where);console.log("There are ".concat(t.length," entities at ").concat(e.where.x,", ").concat(e.where.y));var n=t.length>0;if(e.who){var a=!1;return t.forEach((function(t){t.name===e.who&&(a=!0)})),a}return n}return!1}},{key:"executeResult",value:function(e){switch(e.result.action){case"message":z.send(e.result.params[0]);break;case"load-map":console.log("Going to loadMap",e.result.params[0]);break;case"heal":console.log("Going to heal ".concat(e.where.x,",").concat(e.where.y)),C.getEntitiesAtGivenPosition(e.where).forEach((function(e){var t=e;z.send("Healing ".concat(t.name," from ").concat(t.hp," to ").concat(t.maxHp)),e.hp=e.maxHp}));break;case"move":console.log("Going to heal ".concat(e.where.x,",").concat(e.where.y)),C.getEntitiesAtGivenPosition(e.where).forEach((function(t){var n=t,a=n,i=e.result.params[0];z.send("Moving ".concat(n.name," from ").concat(a.position.x,", ").concat(a.position.y," to\n          ").concat(i.x,",").concat(i.y)),n.position.x=i.x,n.position.y=i.y}))}}}]),e}()),ee=new(function(){function e(){Object(s.a)(this,e),this.model=void 0,this.run=function(){console.log("Running Game Logic"),console.log($.entities)},this.calculateNextInterfaceState=function(e){var t=e,n=t.entities,a=t.selected;return n.forEach((function(e){e===a&&I.markAvailableDestinationsForSelectedEntity(a)})),t},this.syncSquaresWithEntities=function(e){var t,n=(t=e.squares,[].concat(t));I.squares=n;var a=C.entities;return a.length&&p(n,"entity","entities"),a.forEach((function(e){I.setEntityWithinApropriateSquare(e)})),{squares:n,entities:a}},this.deselectAllEntities=function(){p(C.entities,"active"),p(I.squares,"isChosenDestination","isAvailableDestination")},this.ceaseFire=function(){p($.entities,"isShooting")},this.model=$}return Object(r.a)(e,[{key:"calculeteNextGameStateAfterProcessingAGivenEntity",value:function(e,t){if(0===t.actionPoints)return e;var n=e,a=n.entities;return this.processAnEntity(t),n.enemiesAlive=this.calculateNumberOfAliveEnemies(a),n.friendsAlive=this.calculateNumberOfAliveFriends(a),Q.runScripts(t),n}},{key:"processAnEntity",value:function(e){console.log("start procesing",e),C.moveEntityRandomly(e),C.moveEntityIntoChosenDestination(e),C.stopShootingWhenForbidden(e),C.isEntityTargettingSomethingAlive(e)&&C.fireAShot(e),C.ceaseFireNextTickIfNoAliveTargets(e),e.bleedExternally(),C.stopBreathingForKilledEntity(e),I.markAvailableDestinationsForSelectedEntity(e),console.log("end procesing",e)}},{key:"calculateNumberOfAliveFriends",value:function(e){return e.filter((function(e){return e.isFriendly&&e.isAlive})).length}},{key:"calculateNumberOfAliveEnemies",value:function(e){var t=0;return e.forEach((function(e){e.isFriendly||e.isAlive&&t++})),t}}]),e}()),te=ee,ne=function e(){Object(s.a)(this,e),Object.assign(this,{entities:C.entities,squares:I.squares,selected:C.selected,targeted:null,targetedSquareNumber:null,arenaSize:10,squareSize:40,enemiesAlive:te.calculateNumberOfAliveEnemies(C.entities),friendsAlive:te.calculateNumberOfAliveFriends(C.entities),isAutoLoopOn:!1,isBoardRotated:!1,isEditorOn:!1})},ae=null,ie=function(){function e(t){var n=this;Object(s.a)(this,e),this.entitiesProcessingLoopIntervalHandle=null,this.toggleEditorMode=function(){ae.state.isEditorOn?ae.setState((function(e){return{squares:I.squares,entities:C.entities,isEditorOn:!1}})):(p(ae.state.squares,"blood","entity"),ae.setState((function(e){return{entities:[],isEditorOn:!0}})))},this.loop=function(){console.debug("Attempting loop"),n.isTurnInProgress?setTimeout(n.loop,1e3):(console.debug("Executing nextStep"),n.nextStep(),ae.state.isAutoLoopOn&&(console.debug("Scheduling next loop step in 1s"),setTimeout(n.loop,1e3)))},this.nextTick=function(){ae.setState({isAutoLoopOn:!1}),n.nextStep()},this.executeActions=function(){ae.setState((function(e){return ee.calculeteNextGameStateAfterProcessingAGivenEntity(e,e.selected)}),(function(){return n.setSquaresAccordingToEntities()})),n.processInterface()},this.handleKeyPress=function(e){switch(console.log(e),e){case"space":n.executeActions()}},this.handleClickV2=function(e){ae.setState((function(t){var n=t.squares,a=t.entities,i=t.selected,o=t.targeted,s=t.isEditorOn,r=t.targetedSquareNumber,c=o;o=n[e],r=e;var l=function(){return c===o};if(I.markSquareAtIndexAsTargeted(e),s)switch(o.squareType){case"floor":o.squareType="wall";break;case"wall":o.squareType="nothing";break;case"nothing":o.squareType="monster-filter";break;case"monster-filter":o.squareType="floor"}if(l()&&o.isAvailableDestination&&(i.setMoveDestinationSquareByNumber(e),delete i.targetPosition,delete i.isShooting,p(n,"isAttacked")),(l()||i)&&(!i&&o.entity?i=C.selectEntityFromGivenSquare(i,o):function(e,t){e&&t&&t.entity&&(e.name,t.entity.name)}(i,o)),l()&&i&&o.entity&&i!==o.entity){var u=I.getSquarePositionFromIndex(e);i.attackPosition(u),I.markSquareAtIndexAsAttacked(e),delete i.moveDestination,delete i.isShooting,p(n,"isChosenDestination")}return{squares:n,entities:a,selected:i,targeted:o,targetedSquareNumber:r}}),(function(){return n.processInterface()}))},this.aggro=function(e){var t=e.position,a=n.findEntitiesThatAreClose(t).filter((function(e){return e.hp>0}));if(a.length){var i=a[0];e.attackPosition(i.position)}},this.nuke=function(e){ae.setState((function(t){var n=t.entities;return n.forEach((function(t){t.hp=t.hp-e})),{entities:n}}),(function(){n.processEntities()}))},this.toggleRotateBoard=function(){ae.setState({isBoardRotated:!ae.state.isBoardRotated})},this.switchAutoLoop=function(){ae.setState((function(e){var t=!e.isAutoLoopOn;return console.info("Switching auto loop to",t),{isAutoLoopOn:t}}),(function(){ae.state.isAutoLoopOn&&n.loop()}))},this.onInventoryClick=function(e,t){ae.setState((function(n){var a=[].concat(n.entities);C.entities=a;var i=C.getEntityId(e),o=C.findEntityById(i);return o.equipment.hands&&o.equipment.hands.name===t?o.unEquipFromHands():o.equipInHands(t),{entities:a}})),console.log(e,t)},this.handleDeselectAllEntities=function(){ae.setState((function(e){var t=e.squares,n=e.entities;e.selected;return ee.deselectAllEntities(),void 0,{squares:t,entities:n,selected:void 0}}),(function(){}))},this.ceaseFire=function(){p(C.entities,"isShooting"),n.processInterface()},ae=t}return Object(r.a)(e,[{key:"zoomIn",value:function(){ae.setState((function(e){return{squareSize:e.squareSize+5}}))}},{key:"zoomOut",value:function(){ae.setState((function(e){return{squareSize:e.squareSize-5}}))}},{key:"nextStep",value:function(){ae.stepNumber++,console.info("Starting processing turn #",ae.stepNumber),C.refillActionPointsForAllEntities(),p(C.entities,"targetPosition","isShooting"),p(I.squares,"isAttacked"),this.processEntities()}},{key:"processEntities",value:function(){var e=this;this.drawAggro(),this.entitiesProcessingLoopIntervalHandle=setInterval((function(){return e.processNextUnprocessedEntity()}),100)}},{key:"processNextUnprocessedEntity",value:function(){var e=C.entities.filter((function(e){return!e.isFriendly&&e.isAlive&&e.actionPoints>0}));if(e.length){var t=e[0];this.setNewStateAfterProcessingChosenEntity(t)}else clearInterval(this.entitiesProcessingLoopIntervalHandle),this.entitiesProcessingLoopIntervalHandle=null,console.log("All entities processed.")}},{key:"setNewStateAfterProcessingChosenEntity",value:function(e){var t=this;ae.setState((function(t){return ee.calculeteNextGameStateAfterProcessingAGivenEntity(t,e)}),(function(){return t.setSquaresAccordingToEntities()})),this.processInterface()}},{key:"processInterface",value:function(){var e=this;ae.setState((function(e){return ee.calculateNextInterfaceState(e)}),(function(){return e.setSquaresAccordingToEntities()}))}},{key:"setSquaresAccordingToEntities",value:function(){ae.setState((function(e){return ee.syncSquaresWithEntities(e)}))}},{key:"drawAggro",value:function(){var e=this;C.entities.forEach((function(t){t.isFriendly||(t.isShooting=!1,e.aggro(t))}))}},{key:"findEntitiesThatAreClose",value:function(e){for(var t=e.x,n=e.y,a=[],i=n-1;i<=n+1;i++)if(!(i<0||i>=I.arenaSize))for(var o=t-1;o<=t+1;o++)if(!(o<0||o>=I.arenaSize||o===t&&i===n)){var s=C.getEntitiesAtGivenPosition({x:o,y:i});a=a.concat(s)}return a}},{key:"isTurnInProgress",get:function(){return this.entitiesProcessingLoopIntervalHandle}}]),e}();n(19);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var se=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).renderCount=0,n.handleInventoryClick=function(e){n.props.onInventoryClick(n.props.entity,e)},n.onDrop=function(e){var t=n.props.entity;t.equipment.hands&&t.equipment.hands.name===e&&(t.unEquipFromHands(),t.isShooting=!1);var a=t.takeFromInventory(e);a instanceof B?(console.log("Dropping Item"),t.square.addItem(a)):a instanceof _&&(console.log("Dropping Entity"),C.addEntity(a),t.square.entity=a,a.position=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(n,!0).forEach((function(t){Object(q.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.position)),n.props.processInterface()},n.onReload=function(e){var t=n.props.entity;t.equipment.hands&&t.equipment.hands.name===e&&(t.isShooting=!1),n.props.processInterface()},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props.entity;if(!t)return null;var n="entity-card";t.active&&(n+=" entity-card--active"),t.isFriendly&&(n+=" entity-card--friendly"),t.isDead&&(n+=" entity-card--dead");var a,o,s=t.equipment&&t.equipment.hands,r=s&&[s];return t.bleedingReductionPerTurn&&(o=i.a.createElement("span",{className:"bleeding-info__reduction"},"(-",t.bleedingReductionPerTurn,i.a.createElement("small",{className:"bleeding-info__reduction__unit"},"/Turn"),")")),t.bleeding&&(a=i.a.createElement("span",{className:"bleeding-info"},"Bleeding: ",t.bleeding," ",o)),i.a.createElement("div",{className:n},i.a.createElement("button",{className:"inventory-list__drop-button",onClick:function(){return e.props.onEntityClick(t.name)}},"Pick up"),i.a.createElement("div",null,i.a.createElement("div",{className:"entity-card__portrait"},t.icon)),i.a.createElement("strong",{title:"Name"},t.name),i.a.createElement("br",null),i.a.createElement("small",{className:"entity-data__rank"},"Private"),i.a.createElement("div",null,i.a.createElement(be,{className:"full",label:"AP",current:t.actionPoints,max:t.maxActionPoints}),i.a.createElement(be,{className:"full",label:"HP",current:t.hp,max:t.maxHp}),a,i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("span",{title:"Location",className:"entity-data__location"},"LOC: ",t.position.x,", ",t.position.y),i.a.createElement("span",{title:"Distance to target",hidden:!t.targetPosition,className:"entity-data__distance-to-target"},"DIST: ",this.distanceToTarget),i.a.createElement("span",{title:"Target location",hidden:!t.targetPosition,className:"entity-data__target-position"},"TRGT: ",t.targetPosition&&t.targetPosition.x,", ",t.targetPosition&&t.targetPosition.y),i.a.createElement("br",null)),i.a.createElement(je,{label:"Equipped",title:"In hands",onClick:this.handleInventoryClick,onDrop:this.onDrop,onReload:this.onReload,inventory:r,processInterface:function(){return e.props.processInterface()}}),i.a.createElement(je,{label:"Inventory",title:"In backpack",onClick:this.handleInventoryClick,onDrop:this.onDrop,onReload:this.onReload,inventory:t.inventory,processInterface:function(){return e.props.processInterface()}}))}},{key:"distanceToTarget",get:function(){var e=this.props.entity;return e.targetPosition?Number(y(e.targetPosition.x-e.position.x,e.targetPosition.y-e.position.y).toFixed(2)):null}}]),t}(i.a.Component),re=(n(20),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).randomTime="".concat((Math.random()+.5).toFixed(2),"s"),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.entity,t=I.getSquareFromPosition(e.position.x,e.position.y),n="".concat("entity-pawn__icon"),a=f(e,"entity-pawn__icon");a+=f(t,"entity-pawn__icon"),n+=" ".concat(a," ");var o=e.isFriendly?"friendly":"hostile",s=e.isFriendly?"green":"red",r=e.isShooting?5:1,c=e.isBreathing?"breathing ".concat(this.randomTime," alternate infinite linear"):"none";return i.a.createElement("div",{className:"entity-pawn",key:e.name,style:{left:"calc(".concat(13,"px + ").concat(2*e.position.x*2,"px + ").concat(e.position.x,"em)"),top:"calc(".concat(13,"px + ").concat(2*e.position.y*2,"px + ").concat(e.position.y,"em)"),zIndex:r}},i.a.createElement("div",{className:"entity-pawn__health-display "+o},i.a.createElement(Pe,{current:e.hp,max:e.maxHp,color:s})),i.a.createElement("div",{className:n,style:{animation:c}},i.a.createElement(ce,{emoji:e.icon})),i.a.createElement(Ae,{entity:e}))}}]),t}(i.a.Component)),ce=(n(21),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).emojiMap={"\ud83d\udc19":"octopus","\ud83e\udd91":"squid","\ud83d\udd77\ufe0f":"spider","\ud83e\udd9f":"mosquito","\ud83d\udc1c":"ant","\ud83e\udda0":"microbe","\ud83e\uddd1\u200d\ud83d\ude80":"astronaut","\ud83e\udd16":"robot","\ud83d\udee2\ufe0f":"oildrum"},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.emoji,t=this.emojiMap[e],n=i.a.createElement(i.a.Fragment,null);return n=t?i.a.createElement("div",{className:"emoji emoji-"+t}):i.a.createElement("div",null,e,"."),i.a.createElement(i.a.Fragment,null,n)}}]),t}(i.a.Component)),le=n(7),ue=n(6),pe=n.n(ue),me=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).boxSerialNumber=0,n.onItemClick=function(e){var t=n.props,a=t.selected,i=t.targeted,o=t.squareNumber,s=I.getSquarePositionFromIndex(o);if(a&&i&&a.position.x===s.x&&a.position.y===s.y){var r=i.takeFromInventory(e);if(!r)r=i.entity,I.getSquareFromPosition(s.x,s.y).entity=null,C.removeEntity(r);a.addToInventory(r)}n.props.processInterface()},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"onMoveClick",value:function(e,t){var n=I.getSquareFromPosition(t.x,t.y);e.setMoveDestinationPosition(t),n.isChosenDestination=!0,this.props.processInterface()}},{key:"onAttackClick",value:function(e,t){e.attackPosition(t),this.props.processInterface()}},{key:"onAddStructureClick",value:function(e,t){var n=Object.assign({},V[t]),a=Object.assign({},e);n.position=a,n.name+=this.boxSerialNumber++;var i=I.getSquareFromPosition(e.x,e.y),o=new _(n);i.entity=o,C.entities.push(o),this.props.processInterface()}},{key:"render",value:function(){var e=this,t=this.props,n=t.targeted,a=t.selected,o=t.squareNumber;if(!n)return null;var s,r,c,l,u=I.getSquarePositionFromIndex(o),p=[],m=[],d=i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){return e.onAddStructureClick(u,"box")},className:pe.a.button},"Add box"),i.a.createElement("button",{onClick:function(){return e.onAddStructureClick(u,"redBarrel")},className:pe.a.button},"Add barrel"));if(n.entities&&n.entities.length&&n.entities.forEach((function(t){a!==t&&p.push(i.a.createElement(se,{onEntityClick:e.onItemClick,onInventoryClick:e.props.onInventoryClick,entity:t,processInterface:function(){return e.props.processInterface()}}))})),n.items&&(l=i.a.createElement(je,{label:"Items in this location",title:"On the floor",onClick:this.onItemClick,onDrop:null,onReload:null,inventory:n.items,processInterface:function(){return e.props.processInterface()}})),a){var h=y(u.x-a.position.x,u.y-a.position.y);s=i.a.createElement("li",null,"Distance to selected: ",h.toFixed(2)),0!==h&&(n.isAvailableDestination&&(m[0]=i.a.createElement("button",{key:"move",onClick:function(){return e.onMoveClick(a,u)},className:pe.a.button},"Move")),n.entity&&(m[1]=i.a.createElement("button",{key:"attack",onClick:function(){return e.onAttackClick(a,u)},className:pe.a.button},"Attack")))}u&&(r=i.a.createElement("li",null,"Position: [ ",u.x,", ",u.y," ]"," ")),n.blood&&(c=i.a.createElement("li",null,"Blood amount: ",n.blood));var f=I.getSquareFromPosition(u.x,u.y);return i.a.createElement("div",{className:this.props.className},i.a.createElement("strong",{className:pe.a.targeted__label},"Target square Info"),i.a.createElement("code",null,f.icon," ",f.name),i.a.createElement("p",null,f.description),i.a.createElement("div",null,p),i.a.createElement("div",null,m),i.a.createElement("ul",null,r,s,c,l,d))}}]),t}(i.a.Component),de=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return this.props.selected?i.a.createElement("div",{className:pe.a.selected},i.a.createElement("strong",{className:pe.a.selected__label},"Selected entity "),i.a.createElement("div",null,i.a.createElement(se,{onInventoryClick:this.props.onInventoryClick,entity:this.props.selected,processInterface:function(){return e.props.processInterface()}})),i.a.createElement("button",{onClick:this.props.handleDeselectAllEntities,className:pe.a.button}," ","Deselect")):null}}]),t}(i.a.Component),he=null,ye=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).renderCounter=0,n.stepNumber=0,$.loadBuiltInMap(),$.loadPredefinedEntitities(),C.setSelected(C.findEntityById("Lazer Blady"),!0),n.state=new ne,he=new ie(Object(le.a)(n)),console.log("Initial state dump:",n.state),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.startIfAutoLoopIsOn()}},{key:"startIfAutoLoopIsOn",value:function(){this.state.isAutoLoopOn&&he.loop()}},{key:"calculateFriendlyActionPoints",value:function(){return C.entities.filter((function(e){return e.isFriendly})).reduce((function(e,t){return e+t.actionPoints}),0)}},{key:"render",value:function(){return i.a.createElement("div",{className:pe.a.game},i.a.createElement("div",{className:pe.a.game__board},i.a.createElement(E,{squares:this.state.squares,entities:this.state.entities,onClick:function(e){return he.handleClickV2(e)},size:this.state.arenaSize,isRotated:this.state.isBoardRotated,style:{fontSize:"".concat(this.state.squareSize,"px")}}),i.a.createElement(ke,{keys:["W","S","A","D","space"],onKeyPress:he.handleKeyPress})),i.a.createElement("div",{className:pe.a.game__info},i.a.createElement("div",{className:pe.a.actions},i.a.createElement("div",{className:pe.a.action_row},i.a.createElement("button",{onClick:he.toggleEditorMode},"Editor Mode"),i.a.createElement("button",{onClick:$.saveMap},"Save Map"),i.a.createElement("button",{onClick:function(){return $.loadMap(he)}},"Load Map")),i.a.createElement("div",{className:pe.a.action_row},i.a.createElement("button",{onClick:he.toggleRotateBoard},"Rotate Board"),i.a.createElement("button",{onClick:he.zoomIn},"Zoom In (+)"),i.a.createElement("button",{onClick:he.zoomOut},"Zoom Out (-)")),i.a.createElement("div",{className:pe.a.action_row},i.a.createElement("button",{onClick:function(){return he.nuke(40)},className:pe.a["button-nuke"]},"Nuke All"),i.a.createElement("button",{onClick:he.ceaseFire},"Cease Fire"),i.a.createElement("button",{onClick:he.executeActions,className:pe.a.execute_actions},"Execute Actions")),i.a.createElement("div",{className:pe.a.action_row},i.a.createElement("span",{className:pe.a["step-counter"]},"Tick: ",this.stepNumber),i.a.createElement("label",{className:" ".concat(pe.a.button," ").concat(pe.a["auto-cycle"])},i.a.createElement("input",{type:"checkbox",checked:this.state.isAutoLoopOn,onChange:he.switchAutoLoop}),i.a.createElement("span",null,"Auto Cycle")),i.a.createElement("button",{onClick:he.nextTick,className:pe.a.button+" "+pe.a.next_tick},"Next Tick")),i.a.createElement("div",{className:pe.a.action_row},i.a.createElement("span",null,"Enemies alive: ",this.state.enemiesAlive," ",i.a.createElement("br",null),"Friends alive: ",this.state.friendsAlive," ",i.a.createElement("br",null),this.state.enemiesAlive&&!this.state.friendsAlive?"YOU LOST":"",this.state.friendsAlive&&!this.state.enemiesAlive?"YOU WON":""),"\xa0",i.a.createElement("p",{className:"instructions"}),i.a.createElement("span",null,"Friends actions points: ",this.calculateFriendlyActionPoints()," "))),i.a.createElement("div",{className:pe.a["interaction-container"]},i.a.createElement(de,{selected:this.state.selected,handleDeselectAllEntities:he.handleDeselectAllEntities,onInventoryClick:he.onInventoryClick,processInterface:function(){return he.processInterface()}}),i.a.createElement(me,{className:pe.a.targeted,squareNumber:this.state.targetedSquareNumber,squares:this.state.squares,selected:this.state.selected,targeted:this.state.targeted,onInventoryClick:he.onInventoryClick,processInterface:function(){return he.processInterface()}}),i.a.createElement("div",null)),i.a.createElement(Oe,null)))}}]),t}(i.a.PureComponent),fe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.bloodAmount;if(!(e<0)){for(var t=[],n=e;n--;)t.push(i.a.createElement("span",{className:"blood__drop",style:{position:"absolute",fontSize:"".concat(1+3*Math.random(),"em"),left:"calc(".concat(0+100*Math.random(),"% - 0.4em)"),top:"calc(".concat(0+100*Math.random(),"% - 0.5em)")}},"o"));return i.a.createElement("div",{className:"square__blood",style:{background:"rgba(255, 0, 0, 0)"}},t,i.a.createElement("span",{className:"blood__text"},e))}console.error("Blood amount negative.")}}]),t}(i.a.PureComponent),ve=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).itemsIcons=[],n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.items,a=t.itemsNumber;return n?(n.forEach((function(t){var n=t;n.icon&&e.itemsIcons.push(i.a.createElement("div",{className:"square__item-icon"},n.icon))})),i.a.createElement("div",{className:"square__items"},i.a.createElement("div",{className:"square__items-icons"},this.itemsIcons),i.a.createElement("div",{className:"square__items-number"},a))):null}}]),t}(i.a.PureComponent),ge=(n(22),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).onClick=function(){n.props.onClick(n.props.squareId)},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=I.squares[this.props.squareId].icon;return i.a.createElement("button",{className:this.props.className,onClick:this.onClick},i.a.createElement("div",{className:"square__content"},e),i.a.createElement(fe,{bloodAmount:this.props.blood}),i.a.createElement(ve,{items:this.props.items,itemsNumber:this.props.itemsNumber}),function(e){for(var t=6,n=[];t--;)n.push(i.a.createElement("div",{key:t,className:"".concat(e,"__cuboid-face")}));return i.a.createElement("div",{className:"".concat(e,"__cuboid")},n)}("square"))}}]),t}(i.a.PureComponent));n(23);function be(e){var t="linear-display ".concat(e.className||""),n=~~(100*e.current/e.max),a=n>100,o=n<0;a&&(n=100,t+=" linear-display--overloaded"),o&&(n=0);var s={width:"".concat(n,"%")},r=e.title||"".concat(e.current,"/").concat(e.max),c=e.current,l=1;e.max>=40&&e.max<100?l=5:e.max>=100&&(l=10);var u={backgroundSize:"".concat(100/(c/=l),"% 100%"),backgroundImage:"\n      linear-gradient(to left, ".concat("black"," 1px, transparent 1px)\n    ")};return Object.assign(s,u),i.a.createElement("div",{className:t},i.a.createElement("div",{className:"linear-display__label"},e.label,e.label?":":"","\xa0"),i.a.createElement("div",{className:"linear-display__bar-container",title:r},i.a.createElement("div",{className:"linear-display__bar-progress",style:s},i.a.createElement("span",{className:"linear-display__bar-progress-text"},e.current,a?"/"+e.max:"","\xa0"))),i.a.createElement("div",null,"\xa0"))}n(24);var xe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"hud-panel"},i.a.createElement("div",{className:"hud-panel__title"},this.props.title),i.a.createElement("div",{className:"hud-panel__content"},this.props.children))}}]),t}(i.a.Component),Ee=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"cell"},this.props.children)}}]),t}(i.a.PureComponent),qe=(n(25),function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"renderGrid",value:function(){for(var e=[],t=0;t<=this.props.height;t++){for(var n=this.props.startAt[1]+t,a=[],o=0;o<=this.props.width;o++){var s=this.props.startAt[0]+o,r=i.a.createElement(Ee,{key:"$key_".concat(s,"_").concat(n)},s,", ",n);a.push(r)}e.push(i.a.createElement("div",{className:"row",key:"$key_X_".concat(n)},a))}return i.a.createElement("div",{className:"grid"},e)}},{key:"render",value:function(){return this.renderGrid()}}]),t}(i.a.Component)),ke=(n(26),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={w:!1,s:!1,a:!1,d:!1,space:!1},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(t){return e.onKeyDown(t)}),!1),document.addEventListener("keyup",(function(t){return e.onKeyUp(t)}),!1)}},{key:"onKeyDown",value:function(e){switch(console.log(e),e.keyCode){case 87:this.setState({w:!0}),this.props.onKeyPress("w");break;case 83:this.setState({s:!0}),this.props.onKeyPress("s");break;case 65:this.setState({a:!0}),this.props.onKeyPress("a");break;case 68:this.setState({d:!0}),this.props.onKeyPress("d");break;case 32:this.setState({space:!0}),this.props.onKeyPress("space")}e.preventDefault()}},{key:"onKeyUp",value:function(e){switch(console.log(e),e.keyCode){case 87:this.setState({w:!1});break;case 83:this.setState({s:!1});break;case 65:this.setState({a:!1});break;case 68:this.setState({d:!1});break;case 32:this.setState({space:!1})}}},{key:"render",value:function(){return i.a.createElement("div",{className:"controls"},"[",i.a.createElement("span",{className:"".concat(this.state.w?"pressed":""," key")},"W"),"] [",i.a.createElement("span",{className:"".concat(this.state.s?"pressed":""," key")},"S"),"] [",i.a.createElement("span",{className:"".concat(this.state.a?"pressed":""," key")},"A"),"] [",i.a.createElement("span",{className:"".concat(this.state.d?"pressed":""," key")},"D"),"] \xa0 [",i.a.createElement("span",{className:"".concat(this.state.space?"pressed":""," key")},"space"),"]")}}]),t}(i.a.Component)),Oe=(n(27),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).messages=z.messages,n.messageNumber=void 0,n.renderMessage=function(e,t){return i.a.createElement("li",{key:"msg".concat(t)},"Message #[",t,"]: ",e)},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(){return this.messages.length!==this.messageNumber}},{key:"render",value:function(){var e=this;if(!this.messages.length)return null;var t=this.messages.map((function(t,n){return e.renderMessage(t,n)}));return this.messageNumber=this.messages.length,i.a.createElement("ul",{className:"messages",id:"messages"},t)}},{key:"scrollElement",value:function(){window.requestAnimationFrame((function(){var e=document.getElementById("messages");e.scrollTop=e.scrollHeight}))}},{key:"componentDidUpdate",value:function(){this.messages.length&&this.scrollElement()}}]),t}(i.a.Component));n(28);function Se(e){var t,n,a,o=e.item;if(e.onDrop&&(n=i.a.createElement("button",{className:"inventory-list__drop-button",onClick:function(){e.onDrop(o.name)}},"Drop")),o instanceof R){var s=o;if(s.reload){var r=" inventory-list__reload-button ";0===s.rounds||"empty"===s.rounds?r+=" inventory-list__reload-button--empty ":s.rounds<s.maxRounds&&(r+=" inventory-list__reload-button--partial "),t=i.a.createElement("button",{className:r,onClick:function(){s.reload(),e.onReload&&e.onReload(o.name),e.processInterface()}},"Reload")}else t=null;a=s.reload?i.a.createElement(be,{className:"full",label:"Rounds",current:s.rounds,max:s.maxRounds}):null}return i.a.createElement("div",{key:o.name},i.a.createElement("div",{onClick:function(){return e.onClick(o.name)},key:o.name,className:"inventory-list__item"},i.a.createElement("span",null,o.name),i.a.createElement("div",null,a)),t,n)}function je(e){var t="inventory-list ".concat(e.className||"");if(!e.inventory)return null;var n=e.inventory.map((function(t){return i.a.createElement(Se,{key:"i".concat(t.name),item:t,onClick:e.onClick,onDrop:e.onDrop,onReload:e.onReload,processInterface:e.processInterface})}));return i.a.createElement("div",{className:t},i.a.createElement("div",{className:"inventory-list__label"},e.label,":\xa0"),i.a.createElement("div",{className:"inventory-list__items",title:e.title},n))}n(29);var Pe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){if(this.props.current<=0)return null;var e=~~(100*this.props.current/this.props.max),t={width:"".concat(e,"%"),backgroundColor:this.props.color};return i.a.createElement("div",{className:"hpbar"},i.a.createElement("div",{className:"hpbar__indicator",style:t}),i.a.createElement("span",{className:"hpbar__text"},this.props.current))}}]),t}(i.a.Component);function Ae(e){var t=e.entity,n=h,a=t.targetPosition,o=5,s=[],r="Entity".concat(t.icon),c="shooting-animation-".concat(r,"-ap-").concat(t.actionPoints),l="",u="";if(a&&t.position&&t.hasWeapon&&t.isShooting&&(t.targetPosition.x!==t.position.x||t.targetPosition.y!==t.position.y)&&a){var p=a.x-t.position.x,m=a.y-t.position.y,d=y(p,m),f=t&&t.equipment&&t.equipment.hands&&t.equipment.hands.type,v=n(p,m);if(u="\n      @keyframes fading".concat(c," {\n        0%  {opacity: 1;}\n        95% {opacity: 1;}\n        100%  {opacity: 0;}\n      }\n\n      .fading-after-1s-for-").concat(c," {\n        animation: fading").concat(c," 1s linear normal forwards 1;\n      }\n      "),"lazer"===f){var g="projectile".concat(r,"_beam");l="\n          @keyframes pulsing".concat(r," {\n            0%  {opacity: 0.1;}\n            100%  {opacity: 1;}\n          }\n\n          @keyframes elongating").concat(r," {\n            0%  { width: calc(").concat(d,"em + ").concat(d," * 4px - 20px); }\n            100%  {width: calc(").concat(d,"em + ").concat(d," * 4px - 20px); }\n          }\n\n          @keyframes swiping").concat(r," {\n            0%  {transform: rotate(").concat(v+90-1,"deg) translateX(").concat(20,"px);}\n            50%  {transform: rotate(").concat(v+90+1,"deg) translateX(").concat(20,"px);}\n            100%  {transform: rotate(").concat(v+90-1,"deg) translateX(").concat(20,"px);}\n          }\n\n          .").concat(g," {\n            width: ").concat(d,"em;\n            height: 3px;\n            border-radius: 5px;\n            background: #F00;\n            position: absolute;\n            top: 0.5em;\n            left: 0.5em;\n            transform: rotate(").concat(v+90,"deg);/* overriden by swiping keyframes */\n            transform-origin: left 0px;\n            animation: pulsing").concat(r," 0.1s ease infinite,\n            elongating").concat(r," 0.7s ease alternate infinite,\n            swiping").concat(r," 1s ease alternate infinite;\n            box-shadow: 0 0 5px 5px white;\n            z-index: 10;\n          }\n          "),s.push(i.a.createElement("div",{key:g,className:g},""))}else{for(l="\n          @keyframes shooting".concat(r," {\n            0%   {transform: translate(0,0) rotate(").concat(v,"deg) scaleY(0.3)}\n            100% {transform: translate(\n              ").concat(36*(a.x-t.position.x),"px,\n              ").concat(36*(a.y-t.position.y),"px\n            ) rotate(").concat(v,"deg) scaleY(2)}\n          }\n          ");o--;)l+="\n          .projectile".concat(r,"_").concat(o," {\n            transform: rotate(").concat(v,"deg);\n            animation: shooting").concat(r," 0.8s linear infinite;\n            animation-delay: ").concat(o-.3,"s;\n          }");var b=t.isShooting?"|":"";for(o=3;o--;){var x="projectile projectile".concat(r,"_").concat(o);s.push(i.a.createElement("div",{key:x,className:x},b))}}}var E="shooting-visualization fading-after-1s-for-".concat(c);return i.a.createElement("div",{className:E},i.a.createElement("style",null,l+u),s)}n(30),n(31);var Te=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).areaReference=void 0,n.scroll={x:0,y:0},n.onMouseDown=function(e){2===e.button&&(document.addEventListener("mouseup",n.onMouseUp),document.addEventListener("mousemove",n.onMouseMove),e.preventDefault())},n.onMouseMove=function(e){n.scrollRelativeXY(e.movementX,e.movementY)},n.onMouseUp=function(e){document.removeEventListener("mouseup",n.onMouseUp),document.removeEventListener("mousemove",n.onMouseMove),e.preventDefault()},n.areaReference=i.a.createRef(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"scrollRelativeXY",value:function(e,t){this.scroll.x-=e,this.scroll.y-=t,this.scroll.x<=0&&(this.scroll.x=0),this.scroll.y<=0&&(this.scroll.y=0),this.executeScroll()}},{key:"executeScroll",value:function(){this.areaReference.current.scroll({top:this.scroll.y,left:this.scroll.x})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"drag-scroll-area drag-scroll-area-external",ref:this.areaReference,onMouseDown:function(t){return e.onMouseDown(t)},onContextMenu:function(e){return e.preventDefault()}},i.a.createElement("div",{className:"drag-scroll-area drag-scroll-area-internal"},this.props.children))}}]),t}(i.a.Component),we=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={gridX:0,gridY:0},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"onControlPress",value:function(e){var t=0,n=0;switch(e){case"w":n=-1;break;case"s":n=1;break;case"a":t=-1;break;case"d":t=1}console.log(e),this.setState((function(e){return{gridX:e.gridX+t,gridY:e.gridY+n}}))}},{key:"render",value:function(){var e=this,t=i.a.createElement(ke,{keys:["W","S","A","D"],onKeyPress:function(t){return e.onControlPress(t)}}),n=i.a.createElement(i.a.Fragment,null),a=i.a.createElement(i.a.Fragment,null);return i.a.createElement("div",{className:"blast-zone"},i.a.createElement("div",{className:"top-row"},i.a.createElement(xe,{title:"Controls"},t),i.a.createElement(xe,{title:"Console"},n),i.a.createElement(xe,{title:"Status Indicators"},a)),i.a.createElement("div",{className:"mid-row"},i.a.createElement(xe,{title:"Tactical Grid"},i.a.createElement(Te,null,i.a.createElement(qe,{width:100,height:100,startAt:[this.state.gridX,this.state.gridY]})))),i.a.createElement("div",{className:"bottom-row"},i.a.createElement(xe,{title:"OhWell"},i.a.createElement("span",null,":)"))))}}]),t}(i.a.Component),_e=(n(32),function(){}),Ne=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).showRoomList=[{name:"Square",content:i.a.createElement(ge,{squareId:1,onClick:_e,blood:7,items:[],itemsNumber:3})},{name:"Controls",content:i.a.createElement(ke,{keys:["q","e"],onKeyPress:function(e){console.log("ehlo",e)}})},{name:"EmojiMapper",content:i.a.createElement(i.a.Fragment,null," \ud83d\udee2\ufe0f => ",i.a.createElement(ce,{emoji:"\ud83d\udee2\ufe0f"}),", \ud83d\udd77\ufe0f => ",i.a.createElement(ce,{emoji:"\ud83d\udd77\ufe0f"})," ")},{name:"HpBar 66/100",content:i.a.createElement(Pe,{current:66,max:100,color:"green"})},{name:"HpBar 80/100 white",content:i.a.createElement(Pe,{current:66,max:100,color:"white"})},{name:"HpBar 0/100",content:i.a.createElement(Pe,{current:0,max:100,color:"green"})},{name:"HpBar -20/100",content:i.a.createElement(Pe,{current:-20,max:100,color:"green"})},{name:"HpBar 150/100",content:i.a.createElement(Pe,{current:150,max:100,color:"green"})},{name:"InventoryItem",content:i.a.createElement(Se,{item:new L,onDrop:_e,onReload:_e,onClick:_e,processInterface:_e})},{name:"LinearDisplay 66/100",content:i.a.createElement(be,{title:"Title",label:"Label",current:66,max:100})},{name:"LinearDisplay 0/10",content:i.a.createElement(be,{title:"Title",label:"Label",current:0,max:10})},{name:"LinearDisplay 20/25",content:i.a.createElement(be,{title:"Title",label:"Label",current:20,max:25})},{name:"LinearDisplay 30/25",content:i.a.createElement(be,{title:"Title",label:"Label",current:30,max:25})},{name:"LinearDisplay -3/25",content:i.a.createElement(be,{title:"Title",label:"Label",current:-3,max:25})},{name:"LinearDisplay with no label",content:i.a.createElement(be,{current:13,max:20})}],n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.showRoomList.map((function(e){return e.name?i.a.createElement("li",null,i.a.createElement("span",{className:"description"},e.name),i.a.createElement("div",{className:"content"},e.content)):null}));return i.a.createElement("div",{className:"show-room"},i.a.createElement("desc",null,"Show Room to present some of our components.",i.a.createElement("p",null,"Be aware than this exposed some problems with the components working in isolation from the context they were designed for. A great opportunity for improvements.")),i.a.createElement("ul",null,e))}}]),t}(i.a.Component),Ie=(n(33),["Game","BlastZone","ShowRoom"]),Ce=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).scenes={Game:ye,BlastZone:we,ShowRoom:Ne},n.SelectedScene=null,n.handleChange=function(e){console.log(e),console.log(e.target),console.log(e.target.value);var t=e.target.value;n.setState((function(e){return{loadedScene:t}}))},n.state={loadedScene:"Game"},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.scenes[this.state.loadedScene],n=Ie.map((function(e){return i.a.createElement("option",{value:e},e)}));return i.a.createElement("div",{className:"app"},i.a.createElement("div",{className:"meta-bar"},i.a.createElement("div",{className:"app-name"},i.a.createElement("span",{className:"be"},"B"),"lood and ",i.a.createElement("span",{className:"be"},"B"),"u",i.a.createElement("span",{className:"el"},"ll"),"ets"),i.a.createElement("div",{className:"screen-switch"},i.a.createElement("span",null,"Select screen: "),i.a.createElement("select",{value:this.state.loadedScene,onChange:function(t){return e.handleChange(t)}},n))),i.a.createElement(t,null))}}]),t}(i.a.Component);n(34);Object(o.render)(i.a.createElement(Ce,null),document.getElementById("root"))}],[[13,1,2]]]);
//# sourceMappingURL=main.02756b1c.chunk.js.map